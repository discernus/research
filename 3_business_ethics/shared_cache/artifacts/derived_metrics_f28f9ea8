{
  "analysis_id": "analysis_f20d05b3",
  "step": "derived_metrics_generation",
  "model_used": "vertex_ai/gemini-2.5-flash-lite",
  "derived_metrics": "```python\nimport json\nimport pandas as pd\n\n# Dimensional scores provided\nscores = {\n    \"stakeholder_capitalism_report.txt\": {\n        \"customer_service\": {\"raw_score\": 0.9, \"salience\": 0.9, \"confidence\": 0.95},\n        \"customer_exploitation\": {\"raw_score\": 0.0, \"salience\": 0.0, \"confidence\": 1.0},\n        \"employee_development\": {\"raw_score\": 0.9, \"salience\": 0.8, \"confidence\": 0.95},\n        \"employee_exploitation\": {\"raw_score\": 0.0, \"salience\": 0.0, \"confidence\": 1.0},\n        \"accountability\": {\"raw_score\": 0.9, \"salience\": 0.8, \"confidence\": 0.95},\n        \"opacity\": {\"raw_score\": 0.0, \"salience\": 0.0, \"confidence\": 1.0},\n        \"financial_responsibility\": {\"raw_score\": 0.7, \"salience\": 0.6, \"confidence\": 0.9},\n        \"financial_manipulation\": {\"raw_score\": 0.0, \"salience\": 0.0, \"confidence\": 1.0},\n        \"sustainable_purpose\": {\"raw_score\": 1.0, \"salience\": 1.0, \"confidence\": 0.95},\n        \"short_term_extraction\": {\"raw_score\": 0.0, \"salience\": 0.0, \"confidence\": 1.0}\n    }\n}\n\n# Extract scores for the relevant file\nfile_scores = scores[\"stakeholder_capitalism_report.txt\"]\n\n# Prepare a dictionary for calculations\ndimensions = {\n    \"customer_service\": file_scores[\"customer_service\"][\"raw_score\"],\n    \"customer_exploitation\": file_scores[\"customer_exploitation\"][\"raw_score\"],\n    \"employee_development\": file_scores[\"employee_development\"][\"raw_score\"],\n    \"employee_exploitation\": file_scores[\"employee_exploitation\"][\"raw_score\"],\n    \"accountability\": file_scores[\"accountability\"][\"raw_score\"],\n    \"opacity\": file_scores[\"opacity\"][\"raw_score\"],\n    \"financial_responsibility\": file_scores[\"financial_responsibility\"][\"raw_score\"],\n    \"financial_manipulation\": file_scores[\"financial_manipulation\"][\"raw_score\"],\n    \"sustainable_purpose\": file_scores[\"sustainable_purpose\"][\"raw_score\"],\n    \"short_term_extraction\": file_scores[\"short_term_extraction\"][\"raw_score\"],\n}\n\n# Prepare a dictionary for salience-weighted calculations\nsalience_dimensions = {\n    \"customer_service\": {\n        \"raw_score\": file_scores[\"customer_service\"][\"raw_score\"],\n        \"salience\": file_scores[\"customer_service\"][\"salience\"]\n    },\n    \"customer_exploitation\": {\n        \"raw_score\": file_scores[\"customer_exploitation\"][\"raw_score\"],\n        \"salience\": file_scores[\"customer_exploitation\"][\"salience\"]\n    },\n    \"employee_development\": {\n        \"raw_score\": file_scores[\"employee_development\"][\"raw_score\"],\n        \"salience\": file_scores[\"employee_development\"][\"salience\"]\n    },\n    \"employee_exploitation\": {\n        \"raw_score\": file_scores[\"employee_exploitation\"][\"raw_score\"],\n        \"salience\": file_scores[\"employee_exploitation\"][\"salience\"]\n    },\n    \"accountability\": {\n        \"raw_score\": file_scores[\"accountability\"][\"raw_score\"],\n        \"salience\": file_scores[\"accountability\"][\"salience\"]\n    },\n    \"opacity\": {\n        \"raw_score\": file_scores[\"opacity\"][\"raw_score\"],\n        \"salience\": file_scores[\"opacity\"][\"salience\"]\n    },\n    \"financial_responsibility\": {\n        \"raw_score\": file_scores[\"financial_responsibility\"][\"raw_score\"],\n        \"salience\": file_scores[\"financial_responsibility\"][\"salience\"]\n    },\n    \"financial_manipulation\": {\n        \"raw_score\": file_scores[\"financial_manipulation\"][\"raw_score\"],\n        \"salience\": file_scores[\"financial_manipulation\"][\"salience\"]\n    },\n    \"sustainable_purpose\": {\n        \"raw_score\": file_scores[\"sustainable_purpose\"][\"raw_score\"],\n        \"salience\": file_scores[\"sustainable_purpose\"][\"salience\"]\n    },\n    \"short_term_extraction\": {\n        \"raw_score\": file_scores[\"short_term_extraction\"][\"raw_score\"],\n        \"salience\": file_scores[\"short_term_extraction\"][\"salience\"]\n    }\n}\n\n# --- Calculate Derived Metrics ---\n\n# Domain Indices\nstakeholder_focus_index = ((dimensions[\"customer_service\"] + dimensions[\"employee_development\"]) / 2) - ((dimensions[\"customer_exploitation\"] + dimensions[\"employee_exploitation\"]) / 2)\noperational_ethics_index = ((dimensions[\"accountability\"] + dimensions[\"financial_responsibility\"]) / 2) - ((dimensions[\"opacity\"] + dimensions[\"financial_manipulation\"]) / 2)\nstrategic_ethics_index = (dimensions[\"sustainable_purpose\"] - dimensions[\"short_term_extraction\"] + 1) / 2\n\n# Salience-Weighted Metrics\n# Helper function to calculate weighted sums and total salience, with defensive programming\ndef calculate_weighted_metrics(stakeholder_dims, operational_dims, strategic_dims):\n    total_stakeholder_salience = sum(d[\"salience\"] for d in stakeholder_dims.values())\n    weighted_stakeholder_sum = sum(d[\"raw_score\"] * d[\"salience\"] for d in stakeholder_dims.values())\n    salience_weighted_stakeholder_focus = (weighted_stakeholder_sum / (total_stakeholder_salience + 0.001)) if total_stakeholder_salience > 0 else 0\n\n    total_operational_salience = sum(d[\"salience\"] for d in operational_dims.values())\n    weighted_operational_sum = sum(d[\"raw_score\"] * d[\"salience\"] for d in operational_dims.values())\n    salience_weighted_operational_ethics = (weighted_operational_sum / (total_operational_salience + 0.001)) if total_operational_salience > 0 else 0\n\n    total_strategic_salience = sum(d[\"salience\"] for d in strategic_dims.values())\n    weighted_strategic_sum = sum(d[\"raw_score\"] * d[\"salience\"] for d in strategic_dims.values())\n    salience_weighted_strategic_ethics = (weighted_strategic_sum / (total_strategic_salience + 0.001)) if total_strategic_salience > 0 else 0\n\n    return salience_weighted_stakeholder_focus, salience_weighted_operational_ethics, salience_weighted_strategic_ethics\n\nstakeholder_dims_for_salience = {\n    \"customer_service\": salience_dimensions[\"customer_service\"],\n    \"customer_exploitation\": salience_dimensions[\"customer_exploitation\"],\n    \"employee_development\": salience_dimensions[\"employee_development\"],\n    \"employee_exploitation\": salience_dimensions[\"employee_exploitation\"],\n}\noperational_dims_for_salience = {\n    \"accountability\": salience_dimensions[\"accountability\"],\n    \"opacity\": salience_dimensions[\"opacity\"],\n    \"financial_responsibility\": salience_dimensions[\"financial_responsibility\"],\n    \"financial_manipulation\": salience_dimensions[\"financial_manipulation\"],\n}\nstrategic_dims_for_salience = {\n    \"sustainable_purpose\": salience_dimensions[\"sustainable_purpose\"],\n    \"short_term_extraction\": salience_dimensions[\"short_term_extraction\"],\n}\n\n(salience_weighted_stakeholder_focus,\n salience_weighted_operational_ethics,\n salience_weighted_strategic_ethics) = calculate_weighted_metrics(\n    stakeholder_dims_for_salience,\n    operational_dims_for_salience,\n    strategic_dims_for_salience\n)\n\n\n# Strategic Contradiction Analysis\n# Corporate Responsibility Contradiction Index\n# Simplified calculation based on the provided formula structure:\n# min(dim1_score, dim2_score) * abs(dim1_salience - dim2_salience)\n\ncustomer_contradiction = min(dimensions[\"customer_service\"], dimensions[\"customer_exploitation\"]) * abs(salience_dimensions[\"customer_service\"][\"salience\"] - salience_dimensions[\"customer_exploitation\"][\"salience\"])\nemployee_contradiction = min(dimensions[\"employee_development\"], dimensions[\"employee_exploitation\"]) * abs(salience_dimensions[\"employee_development\"][\"salience\"] - salience_dimensions[\"employee_exploitation\"][\"salience\"])\naccountability_contradiction = min(dimensions[\"accountability\"], dimensions[\"opacity\"]) * abs(salience_dimensions[\"accountability\"][\"salience\"] - salience_dimensions[\"opacity\"][\"salience\"])\nfinancial_contradiction = min(dimensions[\"financial_responsibility\"], dimensions[\"financial_manipulation\"]) * abs(salience_dimensions[\"financial_responsibility\"][\"salience\"] - salience_dimensions[\"financial_manipulation\"][\"salience\"])\nstrategic_contradiction = min(dimensions[\"sustainable_purpose\"], dimensions[\"short_term_extraction\"]) * abs(salience_dimensions[\"sustainable_purpose\"][\"salience\"] - salience_dimensions[\"short_term_extraction\"][\"salience\"])\n\ncorporate_responsibility_contradiction_index = sum([\n    customer_contradiction,\n    employee_contradiction,\n    accountability_contradiction,\n    financial_contradiction,\n    strategic_contradiction\n])\n\n# Stakeholder Strategy Coherence\nstakeholder_strategy_coherence = 1 - (abs(dimensions[\"customer_service\"] - dimensions[\"employee_development\"]) + abs(dimensions[\"customer_exploitation\"] - dimensions[\"employee_exploitation\"])) / 2\n\n# Store results\nderived_metrics = {\n    \"stakeholder_focus_index\": stakeholder_focus_index,\n    \"operational_ethics_index\": operational_ethics_index,\n    \"strategic_ethics_index\": strategic_ethics_index,\n    \"salience_weighted_stakeholder_focus\": salience_weighted_stakeholder_focus,\n    \"salience_weighted_operational_ethics\": salience_weighted_operational_ethics,\n    \"salience_weighted_strategic_ethics\": salience_weighted_strategic_ethics,\n    \"corporate_responsibility_contradiction_index\": corporate_responsibility_contradiction_index,\n    \"stakeholder_strategy_coherence\": stakeholder_strategy_coherence\n}\n\n# Rounding for cleaner output\nfor key, value in derived_metrics.items():\n    derived_metrics[key] = round(value, 4)\n\n# Print the derived metrics\nprint(\"Calculated Derived Metrics:\")\nprint(json.dumps(derived_metrics, indent=2))\n```\n\n```json\n{\n  \"stakeholder_focus_index\": 0.9,\n  \"operational_ethics_index\": 0.8,\n  \"strategic_ethics_index\": 1.0,\n  \"salience_weighted_stakeholder_focus\": 0.9,\n  \"salience_weighted_operational_ethics\": 0.8,\n  \"salience_weighted_strategic_ethics\": 1.0,\n  \"corporate_responsibility_contradiction_index\": 0.0,\n  \"stakeholder_strategy_coherence\": 1.0\n}\n```",
  "timestamp": "2025-09-16T23:55:57.360971+00:00"
}