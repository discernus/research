{
  "generation_metadata": {
    "status": "success",
    "functions_generated": 6,
    "output_file": "automatedderivedmetricsagent_functions.py",
    "module_size": 12493,
    "function_code_content": "\"\"\"\nAutomated Derived Metrics Functions\n===================================\n\nGenerated by AutomatedDerivedMetricsAgent for experiment: Test Experiment\nDescription: Test experiment for derived metrics\nGenerated: 2025-08-24T21:08:51.895181+00:00\n\nThis module contains automatically generated calculation functions for derived metrics\nas specified in the framework's natural language descriptions.\n\"\"\"\n\nimport pandas as pd\nimport numpy as np\nfrom typing import Optional, Dict, Any\n\n\ndef calculate_identity_tension(data, **kwargs):\n    \"\"\"\n    Calculate identity_tension: Conflict between tribal dominance and individual dignity dimensions.\n\n    This metric quantifies the tension that arises when a text simultaneously invokes appeals\n    to both group-based dominance and individual human dignity. A high score suggests a\n    complex or conflicted rhetorical strategy. The calculation models this as the\n    interaction between the two dimension scores.\n\n    Formula: tribal_dominance * individual_dignity\n\n    Args:\n        data (pd.Series): A single row of data (as a Series) containing dimension scores.\n        **kwargs: Additional keyword arguments (unused).\n\n    Returns:\n        float: The calculated identity tension score. Returns None if required data is\n               missing or invalid.\n    \"\"\"\n    import pandas as pd\n    import numpy as np\n\n    try:\n        # Column names are derived from the calculation's description as no explicit\n        # schema was provided in the prompt.\n        tribal_dominance_col = 'tribal_dominance'\n        individual_dignity_col = 'individual_dignity'\n\n        tribal_dominance = data[tribal_dominance_col]\n        individual_dignity = data[individual_dignity_col]\n\n        # Ensure both values are valid numbers before calculation.\n        if pd.isna(tribal_dominance) or pd.isna(individual_dignity):\n            return None\n\n        # The product of the two scores models their interaction, or \"tension\".\n        # This value is high only when both dimensions are strongly present.\n        result = float(tribal_dominance) * float(individual_dignity)\n\n        # Ensure the final result is a standard Python float.\n        return float(result)\n\n    except (KeyError, TypeError, ValueError):\n        # KeyError: A required column is missing.\n        # TypeError: A value is not of a numeric type for the operation.\n        # ValueError: A value cannot be converted to a float.\n        return None\n\ndef calculate_emotional_balance(data, **kwargs):\n    \"\"\"\n    Calculate emotional_balance: Difference between hope and fear scores\n\n    Formula: hope - fear\n\n    Args:\n        data (pd.Series): A single row of data represented as a pandas Series.\n        **kwargs: Additional parameters (unused).\n\n    Returns:\n        float: Calculated result or None if insufficient data.\n    \"\"\"\n    import pandas as pd\n    import numpy as np\n\n    try:\n        # Define the column names based on the calculation description\n        hope_col = 'hope'\n        fear_col = 'fear'\n\n        # Extract scores directly. A KeyError will be caught if columns are missing.\n        hope_score = data[hope_col]\n        fear_score = data[fear_col]\n        \n        # Check if either score is null/NaN before calculation\n        if pd.isna(hope_score) or pd.isna(fear_score):\n            return None\n\n        # Perform the calculation\n        # The values are cast to float to ensure consistent output type\n        result = float(hope_score) - float(fear_score)\n\n        # Final check to ensure the result is not NaN, which could occur\n        # with certain non-standard numeric types.\n        if np.isnan(result):\n            return None\n\n        return result\n    except (KeyError, TypeError, ValueError):\n        # KeyError: One of the required columns is not in the data.\n        # TypeError: Data in a column is not of a numeric type.\n        # ValueError: Data cannot be cast to float.\n        return None\n    except Exception:\n        # Catch-all for any other unexpected errors\n        return None\n\ndef calculate_success_climate(data, **kwargs):\n    \"\"\"\n    Calculate success_climate: Difference between compersion and envy scores\n\n    Formula: success_climate = compersion - envy\n\n    Args:\n        data (pd.Series): A single row of data from the DataFrame containing\n                          'compersion' and 'envy' scores.\n        **kwargs: Additional keyword arguments (not used).\n\n    Returns:\n        float: The calculated difference, or None if the necessary data\n               is missing, not numeric, or an error occurs.\n    \"\"\"\n    import pandas as pd\n    import numpy as np\n\n    try:\n        # Based on the calculation description, the required columns are inferred\n        # to be 'compersion' and 'envy'.\n\n        # Convert to numeric, coercing any non-numeric values to NaN. This also\n        # handles if the original data is already numeric.\n        compersion_score = pd.to_numeric(data['compersion'], errors='coerce')\n        envy_score = pd.to_numeric(data['envy'], errors='coerce')\n\n        # Check if either value is NaN (which occurs if data was missing,\n        # None, or non-numeric)\n        if pd.isna(compersion_score) or pd.isna(envy_score):\n            return None\n\n        # Calculate the difference and ensure the result is a standard float\n        result = float(compersion_score - envy_score)\n        return result\n\n    except (KeyError, TypeError, ValueError):\n        # A KeyError will be raised if 'compersion' or 'envy' columns are missing.\n        # A TypeError or ValueError could occur with incompatible data formats\n        # not handled by pd.to_numeric.\n        return None\n    except Exception:\n        # A general exception handler for any other unforeseen errors.\n        return None\n\ndef calculate_relational_climate(data, **kwargs):\n    \"\"\"\n    Calculate relational_climate: Difference between amity and enmity scores\n\n    Formula: relational_climate = amity - enmity\n\n    Args:\n        data (pd.Series): A single row of data from a pandas DataFrame.\n        **kwargs: Additional parameters (not used in this calculation).\n\n    Returns:\n        float: The calculated relational climate score, or None if necessary data is missing or invalid.\n    \"\"\"\n    import pandas as pd\n\n    try:\n        # The calculation requires 'amity' and 'enmity' scores.\n        # As per standard practice, these are assumed to be column names.\n        amity_score = data['amity']\n        enmity_score = data['enmity']\n\n        # Handle cases where data is missing (e.g., None, NaN)\n        if pd.isna(amity_score) or pd.isna(enmity_score):\n            return None\n\n        # Perform the calculation and return the result\n        return float(amity_score) - float(enmity_score)\n\n    except (KeyError, TypeError, ValueError):\n        # Handles missing columns ('amity', 'enmity') or non-numeric data.\n        return None\n    except Exception:\n        # A general catch-all for any other unexpected errors.\n        return None\n\ndef calculate_goal_orientation(data, **kwargs):\n    \"\"\"\n    Calculate goal_orientation: Difference between cohesive goals and fragmentative goals\n\n    Formula: cohesive_goals - fragmentative_goals\n    \n    Args:\n        data: pandas DataFrame with dimension scores\n        **kwargs: Additional parameters\n        \n    Returns:\n        float: Calculated result or None if insufficient data\n    \"\"\"\n    import pandas as pd\n    import numpy as np\n    \n    try:\n        # Since no explicit column names are provided, we infer them from the description.\n        cohesive_col = 'cohesive_goals'\n        fragmentative_col = 'fragmentative_goals'\n        \n        # Use .get() to safely access values, returning None if a column is missing.\n        cohesive_score = data.get(cohesive_col)\n        fragmentative_score = data.get(fragmentative_col)\n        \n        # pd.isna() is a robust way to check for missing values (None or np.nan).\n        # If either required value is missing, the calculation cannot proceed.\n        if pd.isna(cohesive_score) or pd.isna(fragmentative_score):\n            return None\n        \n        # Perform the calculation and ensure the result is a float.\n        return float(cohesive_score - fragmentative_score)\n\n    except Exception:\n        # Return None if any error occurs during the process (e.g., non-numeric types).\n        return None\n\ndef calculate_overall_cohesion_index(data, **kwargs):\n    \"\"\"\n    Calculate overall_cohesion_index: Comprehensive measure combining all dimensions.\n\n    This index provides a holistic score of cohesive flourishing by averaging key\n    sub-indices of the framework. As specific column names were not provided in the\n    prompt's data structure, this function assumes the existence of logical high-level\n    component indices based on the framework's description:\n    - 'social_capital_index'\n    - 'democratic_health_index'\n    - 'discourse_quality_index'\n\n    Formula:\n    overall_cohesion_index = MEAN(social_capital_index, democratic_health_index, discourse_quality_index)\n\n    Args:\n        data (pd.Series or pd.DataFrame): A single row/record of data as a pandas Series\n                                         or a single-row DataFrame.\n        **kwargs: Additional keyword arguments (not used).\n\n    Returns:\n        float: The calculated overall cohesion index, or None if any required\n               component index is missing or non-numeric.\n    \"\"\"\n    import pandas as pd\n    import numpy as np\n\n    # Based on the framework's goals, we assume the overall index is an aggregation\n    # of several high-level component indices.\n    component_indices = [\n        'social_capital_index',\n        'democratic_health_index',\n        'discourse_quality_index'\n    ]\n\n    try:\n        # Handle if a single-row DataFrame is passed instead of a Series\n        if isinstance(data, pd.DataFrame):\n            if len(data) != 1:\n                return None  # Cannot process multi-row DataFrame\n            data = data.iloc[0]\n\n        # Extract values for the component indices\n        values = [data[col] for col in component_indices]\n\n        # Ensure all values are present and numeric before calculation\n        if any(pd.isna(v) for v in values):\n            return None\n\n        # Calculate the mean of the component indices\n        result = np.mean(values)\n\n        return float(result)\n\n    except (KeyError, TypeError, ValueError, IndexError):\n        # KeyError: A required column is missing.\n        # TypeError/ValueError: A value is not numeric.\n        # IndexError: DataFrame passed was empty.\n        return None\n\ndef calculate_all_derived_metrics(data: pd.DataFrame) -> Dict[str, Optional[float]]:\n    \"\"\"\n    Calculate all derived metrics for the given dataset.\n    \n    Args:\n        data: pandas DataFrame with dimension scores\n        \n    Returns:\n        Dictionary mapping metric names to calculated values\n    \"\"\"\n    results = {}\n    \n    # Get all calculation functions from this module\n    import inspect\n    current_module = inspect.getmodule(inspect.currentframe())\n    \n    for name, obj in inspect.getmembers(current_module):\n        if (inspect.isfunction(obj) and \n            name.startswith('calculate_') and \n            name not in ['calculate_all_derived_metrics', 'calculate_derived_metrics']):\n            try:\n                results[name.replace('calculate_', '')] = obj(data)\n            except Exception as e:\n                results[name.replace('calculate_', '')] = None\n                \n    return results\n\n\ndef calculate_derived_metrics(data: pd.DataFrame) -> pd.DataFrame:\n    \"\"\"\n    Template-compatible wrapper function for derived metrics calculation.\n    \n    This function is called by the universal notebook template and returns\n    the original data with additional derived metric columns.\n    \n    Args:\n        data: pandas DataFrame with dimension scores\n        \n    Returns:\n        DataFrame with original data plus derived metric columns\n    \"\"\"\n    # Calculate all derived metrics\n    derived_metrics = calculate_all_derived_metrics(data)\n    \n    # Create a copy of the original data\n    result = data.copy()\n    \n    # Add derived metrics as new columns\n    for metric_name, metric_value in derived_metrics.items():\n        if metric_value is not None:\n            # For scalar metrics, broadcast to all rows\n            result[metric_name] = metric_value\n        else:\n            # For failed calculations, use NaN\n            result[metric_name] = np.nan\n    \n    return result\n",
    "cached_with_code": true
  },
  "derived_metrics_data": {
    "status": "success",
    "original_count": 4,
    "derived_count": 4,
    "derived_metrics": [
      {
        "analysis_id": "analysis_017bbf336a45",
        "result_hash": "50a290afa61d620121d750c41b8f5648411158ba89e5983a4a7d0d5281a18a9b",
        "result_content": {
          "analysis_id": "analysis_017bbf336a45",
          "agent_name": "EnhancedAnalysisAgent",
          "agent_version": "enhanced_v2.1_raw_output",
          "experiment_name": "simple_test",
          "model_used": "vertex_ai/gemini-2.5-pro",
          "raw_analysis_response": "```\n<<<DISCERNUS_ANALYSIS_JSON_v6>>>\n{\n  \"analysis_metadata\": {\n    \"framework_name\": \"cohesive_flourishing_framework\",\n    \"framework_version\": \"10.2\",\n    \"analyst_confidence\": 0.98,\n    \"analysis_notes\": \"The document is a classic political concession speech, a genre characterized by calls for unity and graceful acceptance of defeat. This rhetorical context heavily influences the scoring, leading to high scores on cohesive dimensions (Amity, Hope, Compersion, Cohesive Goals, Individual Dignity) and very low scores on fragmentative dimensions (Enmity, Fear, Envy, Fragmentative Goals, Tribal Dominance). The analysis focuses on the explicit rhetorical strategies employed to bridge divides after a contentious election.\"\n  },\n  \"document_analyses\": [\n    {\n      \"document_id\": \"{artifact_id}\",\n      \"document_name\": \"john_mccain_2008_concession.txt\",\n      \"dimensional_scores\": {\n        \"tribal_dominance\": {\n          \"raw_score\": 0.0,\n          \"salience\": 0.1,\n          \"confidence\": 1.0\n        },\n        \"individual_dignity\": {\n          \"raw_score\": 0.8,\n          \"salience\": 0.9,\n          \"confidence\": 1.0\n        },\n        \"fear\": {\n          \"raw_score\": 0.2,\n          \"salience\": 0.3,\n          \"confidence\": 0.9\n        },\n        \"hope\": {\n          \"raw_score\": 0.9,\n          \"salience\": 0.9,\n          \"confidence\": 1.0\n        },\n        \"envy\": {\n          \"raw_score\": 0.0,\n          \"salience\": 0.0,\n          \"confidence\": 1.0\n        },\n        \"compersion\": {\n          \"raw_score\": 0.9,\n          \"salience\": 1.0,\n          \"confidence\": 1.0\n        },\n        \"enmity\": {\n          \"raw_score\": 0.0,\n          \"salience\": 0.1,\n          \"confidence\": 1.0\n        },\n        \"amity\": {\n          \"raw_score\": 0.9,\n          \"salience\": 1.0,\n          \"confidence\": 1.0\n        },\n        \"fragmentative_goals\": {\n          \"raw_score\": 0.0,\n          \"salience\": 0.0,\n          \"confidence\": 1.0\n        },\n        \"cohesive_goals\": {\n          \"raw_score\": 0.9,\n          \"salience\": 0.9,\n          \"confidence\": 1.0\n        }\n      },\n      \"evidence\": [\n        {\n          \"dimension\": \"tribal_dominance\",\n          \"quote_text\": \"Whatever our differences, we are fellow Americans, and please believe me when I say no association has ever meant more to me than that.\",\n          \"confidence\": 1.0,\n          \"context_type\": \"explicit rejection of in-group/out-group division\"\n        },\n        {\n          \"dimension\": \"individual_dignity\",\n          \"quote_text\": \"This is an historic election, and I recognize the special significance it has for African-Americans and for the special pride that must be theirs tonight.\",\n          \"confidence\": 1.0,\n          \"context_type\": \"acknowledgement of universal opportunity and overcoming past injustice\"\n        },\n        {\n          \"dimension\": \"fear\",\n          \"quote_text\": \"These are difficult times for our country, and I pledge to him tonight to do all in my power to help him lead us through the many challenges we face.\",\n          \"confidence\": 0.9,\n          \"context_type\": \"acknowledgement of challenges without invoking existential threat\"\n        },\n        {\n          \"dimension\": \"hope\",\n          \"quote_text\": \"...to not despair of our present difficulties, but to believe always in the promise and greatness of America.\",\n          \"confidence\": 1.0,\n          \"context_type\": \"direct appeal for optimism and belief in a positive future\"\n        },\n        {\n          \"dimension\": \"envy\",\n          \"quote_text\": \"\",\n          \"confidence\": 1.0,\n          \"context_type\": \"complete absence of resentment or zero-sum thinking; the opposite theme (compersion) is central\"\n        },\n        {\n          \"dimension\": \"compersion\",\n          \"quote_text\": \"In a contest as long and difficult as this campaign has been, his success alone commands my respect for his ability and perseverance. But that he managed to do so by inspiring the hopes of so many millions of Americans... is something I deeply admire and commend him for achieving.\",\n          \"confidence\": 1.0,\n          \"context_type\": \"explicit and detailed expression of admiration for opponent's success\"\n        },\n        {\n          \"dimension\": \"enmity\",\n          \"quote_text\": \"I wish Godspeed to the man who was my former opponent and will be my president...\",\n          \"confidence\": 1.0,\n          \"context_type\": \"explicit rejection of hostility and re-framing of opponent as a legitimate leader\"\n        },\n        {\n          \"dimension\": \"amity\",\n          \"quote_text\": \"I urge all Americans who supported me to join me in not just congratulating him, but offering our next president our good will and earnest effort to find ways to come together...\",\n          \"confidence\": 1.0,\n          \"context_type\": \"direct appeal for friendship, cooperation, and unity\"\n        },\n        {\n          \"dimension\": \"fragmentative_goals\",\n          \"quote_text\": \"\",\n          \"confidence\": 1.0,\n          \"context_type\": \"complete absence of divisive goals; the opposite theme (cohesive goals) is central\"\n        },\n        {\n          \"dimension\": \"cohesive_goals\",\n          \"quote_text\": \"...to find the necessary compromises to bridge our differences and help restore our prosperity, defend our security in a dangerous world, and leave our children and grandchildren a stronger, better country than we inherited.\",\n          \"confidence\": 1.0,\n          \"context_type\": \"explicit outline of shared, positive-sum national objectives\"\n        }\n      ]\n    }\n  ]\n}\n<<<END_DISCERNUS_ANALYSIS_JSON_v6>>>\n```",
          "evidence_hash": "19276b33d576c5ab54a9a100a4db69ed63b93bda0120ab8ffdb6afee3d9c65b7",
          "execution_metadata": {
            "start_time": "2025-08-24T21:03:01.593769+00:00",
            "end_time": "2025-08-24T21:03:35.399112+00:00",
            "duration_seconds": 33.805306
          },
          "input_artifacts": {
            "framework_hash": "aeaf6a196101d31208abb7400b7ca59b1cc0a25d2213f1ab236199a682797225",
            "document_hashes": [
              "ff9b26f20ad6dfa10cbf8ce4b7353fddab5e7cce5879e6b4603b8af60d0a9e35"
            ],
            "num_documents": 1
          },
          "provenance": {
            "security_boundary": {
              "experiment_name": "simple_test_cff",
              "experiment_root": "/Volumes/code/discernus/projects/simple_test_cff",
              "boundary_type": "filesystem",
              "security_level": "experiment_scoped"
            },
            "audit_session_id": "20250824T195143Z_6667212c"
          }
        },
        "cached": true
      },
      {
        "analysis_id": "analysis_b610dc19a06a",
        "result_hash": "efc59351f3b23edf9b3c4a48309d781080d2b4383897f2afc2a03d3c4de29fd5",
        "result_content": {
          "analysis_id": "analysis_b610dc19a06a",
          "agent_name": "EnhancedAnalysisAgent",
          "agent_version": "enhanced_v2.1_raw_output",
          "experiment_name": "simple_test",
          "model_used": "vertex_ai/gemini-2.5-pro",
          "raw_analysis_response": "<<<DISCERNUS_ANALYSIS_JSON_v6>>>\n{\n  \"analysis_metadata\": {\n    \"framework_name\": \"cohesive_flourishing_framework\",\n    \"framework_version\": \"10.2\",\n    \"analyst_confidence\": 0.95,\n    \"analysis_notes\": \"The speech is composed of two distinct but thematically linked sections. The first section critiques judicial and executive overreach, while the second, more emotionally charged section, focuses on crimes committed by undocumented immigrants. The analysis reflects the high intensity of fear, enmity, and tribalism, particularly in the second half which dominates the speech's rhetorical impact.\"\n  },\n  \"document_analyses\": [\n    {\n      \"document_id\": \"{artifact_id}\",\n      \"document_name\": \"steve_king_2017_house_floor.txt\",\n      \"dimensional_scores\": {\n        \"tribal_dominance\": {\n          \"raw_score\": 0.8,\n          \"salience\": 0.9,\n          \"confidence\": 0.95\n        },\n        \"individual_dignity\": {\n          \"raw_score\": 0.1,\n          \"salience\": 0.1,\n          \"confidence\": 0.9\n        },\n        \"fear\": {\n          \"raw_score\": 0.9,\n          \"salience\": 0.9,\n          \"confidence\": 0.95\n        },\n        \"hope\": {\n          \"raw_score\": 0.0,\n          \"salience\": 0.0,\n          \"confidence\": 0.9\n        },\n        \"envy\": {\n          \"raw_score\": 0.6,\n          \"salience\": 0.6,\n          \"confidence\": 0.85\n        },\n        \"compersion\": {\n          \"raw_score\": 0.0,\n          \"salience\": 0.0,\n          \"confidence\": 0.9\n        },\n        \"enmity\": {\n          \"raw_score\": 0.8,\n          \"salience\": 0.8,\n          \"confidence\": 0.9\n        },\n        \"amity\": {\n          \"raw_score\": 0.0,\n          \"salience\": 0.0,\n          \"confidence\": 0.9\n        },\n        \"fragmentative_goals\": {\n          \"raw_score\": 0.8,\n          \"salience\": 0.9,\n          \"confidence\": 0.95\n        },\n        \"cohesive_goals\": {\n          \"raw_score\": 0.2,\n          \"salience\": 0.2,\n          \"confidence\": 0.8\n        }\n      },\n      \"evidence\": [\n        {\n          \"dimension\": \"tribal_dominance\",\n          \"quote_text\": \"This President has, has released, his administration has released over 30,000 criminals, criminal aliens onto the streets of America. And of those that they released, there have been at least 124 of them who have been charged with homicide for 135 murders. That's 135 dead Americans that would be alive today if the President didn't have the policy of releasing criminal, criminal aliens onto the streets.\",\n          \"confidence\": 0.95,\n          \"context_type\": \"in_group_victimhood_narrative\"\n        },\n        {\n          \"dimension\": \"individual_dignity\",\n          \"quote_text\": \"That being one of God's children is good enough to be protected by the law, but everybody treated equally.\",\n          \"confidence\": 0.8,\n          \"context_type\": \"closing_statement_appeal\"\n        },\n        {\n          \"dimension\": \"fear\",\n          \"quote_text\": \"This illegal alien beat this boy to death and then he went and bought gasoline and burned his body. He hauled his body out and and put gas and poured gasoline on it and burned this Joshua Wilkerson's body and then he went and took a shower and went to a movie as if it was just another day in the life of.\",\n          \"confidence\": 0.95,\n          \"context_type\": \"graphic_victim_narrative\"\n        },\n        {\n          \"dimension\": \"hope\",\n          \"quote_text\": \"\",\n          \"confidence\": 0.9,\n          \"context_type\": \"no_evidence_found\"\n        },\n        {\n          \"dimension\": \"envy\",\n          \"quote_text\": \"He was out on $5,000 bail, which was less than it cost him to bury his daughter. And that individual absconded back out of the United States, now not to be reached again by the arm of the law, which is not long enough because they put him out on bail.\",\n          \"confidence\": 0.9,\n          \"context_type\": \"grievance_over_perceived_injustice\"\n        },\n        {\n          \"dimension\": \"compersion\",\n          \"quote_text\": \"\",\n          \"confidence\": 0.9,\n          \"context_type\": \"no_evidence_found\"\n        },\n        {\n          \"dimension\": \"enmity\",\n          \"quote_text\": \"And instead of being restored, it [the Constitution] would be destroyed by another presidential appointment.\",\n          \"confidence\": 0.9,\n          \"context_type\": \"adversarial_framing_of_political_opponent\"\n        },\n        {\n          \"dimension\": \"amity\",\n          \"quote_text\": \"\",\n          \"confidence\": 0.9,\n          \"context_type\": \"no_evidence_found\"\n        },\n        {\n          \"dimension\": \"fragmentative_goals\",\n          \"quote_text\": \"And when they're done, send them back to the country that they can live in legally for the rest of their lives if they don't stay in our prisons for the rest of their lives.\",\n          \"confidence\": 0.95,\n          \"context_type\": \"policy_proposal_for_group_removal\"\n        },\n        {\n          \"dimension\": \"cohesive_goals\",\n          \"quote_text\": \"We have a Constitution to preserve, protect, defend, and support and defend.\",\n          \"confidence\": 0.85,\n          \"context_type\": \"appeal_to_shared_foundational_document\"\n        }\n      ]\n    }\n  ]\n}\n<<<END_DISCERNUS_ANALYSIS_JSON_v6>>>",
          "evidence_hash": "459524853069003575f2747dae814312757202ca63d59c32bebe31f524f55f06",
          "execution_metadata": {
            "start_time": "2025-08-24T21:03:35.401532+00:00",
            "end_time": "2025-08-24T21:04:25.761786+00:00",
            "duration_seconds": 50.360239
          },
          "input_artifacts": {
            "framework_hash": "aeaf6a196101d31208abb7400b7ca59b1cc0a25d2213f1ab236199a682797225",
            "document_hashes": [
              "738780d93cc3c43b7b2e292a7fd0aa9f7e438f7ad2555be4ce6bfc20d9efda82"
            ],
            "num_documents": 1
          },
          "provenance": {
            "security_boundary": {
              "experiment_name": "simple_test_cff",
              "experiment_root": "/Volumes/code/discernus/projects/simple_test_cff",
              "boundary_type": "filesystem",
              "security_level": "experiment_scoped"
            },
            "audit_session_id": "20250824T195143Z_6667212c"
          }
        },
        "cached": true
      },
      {
        "analysis_id": "analysis_e8014b3eb101",
        "result_hash": "e4274f709ad863c7406c76683c1807bd38044b7fce0cd6c42d86f6078617f023",
        "result_content": {
          "analysis_id": "analysis_e8014b3eb101",
          "agent_name": "EnhancedAnalysisAgent",
          "agent_version": "enhanced_v2.1_raw_output",
          "experiment_name": "simple_test",
          "model_used": "vertex_ai/gemini-2.5-pro",
          "raw_analysis_response": "<<<DISCERNUS_ANALYSIS_JSON_v6>>>\n{\n  \"analysis_metadata\": {\n    \"framework_name\": \"cohesive_flourishing_framework\",\n    \"framework_version\": \"10.2\",\n    \"analyst_confidence\": 0.95,\n    \"analysis_notes\": \"The analyzed document is a political speech with a clear populist, anti-oligarchy message. The rhetorical strategy is consistent and pronounced, involving the clear definition of an 'in-group' (the American people/working class) and an 'out-group' (the billionaire class/oligarchs). This made scoring dimensions related to conflict, such as Tribal Dominance, Envy, and Enmity, straightforward. The speech also employs a classic problem/solution structure, establishing a crisis (Fear) and then offering a unifying path forward (Hope, Amity, Cohesive Goals), leading to significant scores in these opposing dimensions. The salience scores often reflect the structural importance of a theme (e.g., Hope as a concluding call to action) even if its overall intensity throughout the text is moderate.\"\n  },\n  \"document_analyses\": [\n    {\n      \"document_id\": \"{artifact_id}\",\n      \"document_name\": \"bernie_sanders_2025_fighting_oligarchy.txt\",\n      \"dimensional_scores\": {\n        \"tribal_dominance\": {\n          \"raw_score\": 0.8,\n          \"salience\": 0.9,\n          \"confidence\": 1.0\n        },\n        \"individual_dignity\": {\n          \"raw_score\": 0.1,\n          \"salience\": 0.1,\n          \"confidence\": 0.9\n        },\n        \"fear\": {\n          \"raw_score\": 0.8,\n          \"salience\": 0.8,\n          \"confidence\": 1.0\n        },\n        \"hope\": {\n          \"raw_score\": 0.6,\n          \"salience\": 0.8,\n          \"confidence\": 1.0\n        },\n        \"envy\": {\n          \"raw_score\": 0.9,\n          \"salience\": 0.9,\n          \"confidence\": 1.0\n        },\n        \"compersion\": {\n          \"raw_score\": 0.0,\n          \"salience\": 0.0,\n          \"confidence\": 1.0\n        },\n        \"enmity\": {\n          \"raw_score\": 0.9,\n          \"salience\": 0.9,\n          \"confidence\": 1.0\n        },\n        \"amity\": {\n          \"raw_score\": 0.7,\n          \"salience\": 0.8,\n          \"confidence\": 1.0\n        },\n        \"fragmentative_goals\": {\n          \"raw_score\": 0.8,\n          \"salience\": 0.8,\n          \"confidence\": 0.95\n        },\n        \"cohesive_goals\": {\n          \"raw_score\": 0.7,\n          \"salience\": 0.8,\n          \"confidence\": 1.0\n        }\n      },\n      \"evidence\": [\n        {\n          \"dimension\": \"tribal_dominance\",\n          \"quote_text\": \"Abraham Lincoln talked about a government of the people, by the people, for the people. Well, Trump has a government of the billionaires, by the billionaires, and for the billionaires.\",\n          \"confidence\": 1.0,\n          \"context_type\": \"explicit_group_contrast\"\n        },\n        {\n          \"dimension\": \"individual_dignity\",\n          \"quote_text\": \"\",\n          \"confidence\": 0.5,\n          \"context_type\": \"absence_of_evidence\"\n        },\n        {\n          \"dimension\": \"fear\",\n          \"quote_text\": \"They are prepared to destroy Social Security, Medicaid, Medicare, the Veterans Administration in order to make themselves even richer.\",\n          \"confidence\": 1.0,\n          \"context_type\": \"threat_to_social_welfare\"\n        },\n        {\n          \"dimension\": \"hope\",\n          \"quote_text\": \"So if we stand together, are strong, are disciplined, are smart, I have every reason to believe deeply in my heart that not only will we defeat Trumpism, but we can create the kind of nation that we deserve.\",\n          \"confidence\": 1.0,\n          \"context_type\": \"concluding_call_to_action\"\n        },\n        {\n          \"dimension\": \"envy\",\n          \"quote_text\": \"Meanwhile, there has been a $75 trillion transfer of wealth from the bottom 90% to the top 1%. That is what a rigged economy is about, and that is what we are going to change.\",\n          \"confidence\": 1.0,\n          \"context_type\": \"systemic_unfairness_claim\"\n        },\n        {\n          \"dimension\": \"compersion\",\n          \"quote_text\": \"\",\n          \"confidence\": 1.0,\n          \"context_type\": \"absence_of_evidence\"\n        },\n        {\n          \"dimension\": \"enmity\",\n          \"quote_text\": \"The rich want to get richer and they don't care who they step on.\",\n          \"confidence\": 1.0,\n          \"context_type\": \"character_assassination\"\n        },\n        {\n          \"dimension\": \"amity\",\n          \"quote_text\": \"So if we stand together, are strong, are disciplined, are smart, I have every reason to believe...\",\n          \"confidence\": 1.0,\n          \"context_type\": \"call_for_in-group_solidarity\"\n        },\n        {\n          \"dimension\": \"fragmentative_goals\",\n          \"quote_text\": \"We will not accept the richest guy in the world running all over Washington, making cuts to the Social Security Administration, cuts to the Veterans Administration, almost destroying the Department of Education, all so that they could give over a trillion dollars in tax breaks to the wealthiest 1%.\",\n          \"confidence\": 1.0,\n          \"context_type\": \"attribution_of_divisive_aims\"\n        },\n        {\n          \"dimension\": \"cohesive_goals\",\n          \"quote_text\": \"...we can create the kind of nation that we deserve.\",\n          \"confidence\": 1.0,\n          \"context_type\": \"unifying_vision_statement\"\n        }\n      ]\n    }\n  ]\n}\n<<<END_DISCERNUS_ANALYSIS_JSON_v6>>>",
          "evidence_hash": "220a08b4d5cf7775ea52952b13da593f9ebd2027c78c1076379280fe432ea1e9",
          "execution_metadata": {
            "start_time": "2025-08-24T21:04:25.763669+00:00",
            "end_time": "2025-08-24T21:05:06.204552+00:00",
            "duration_seconds": 40.440871
          },
          "input_artifacts": {
            "framework_hash": "aeaf6a196101d31208abb7400b7ca59b1cc0a25d2213f1ab236199a682797225",
            "document_hashes": [
              "261b893a384411f76907e78e7997860cd9be5d959334a6b9ae1386ea1ba6cbdd"
            ],
            "num_documents": 1
          },
          "provenance": {
            "security_boundary": {
              "experiment_name": "simple_test_cff",
              "experiment_root": "/Volumes/code/discernus/projects/simple_test_cff",
              "boundary_type": "filesystem",
              "security_level": "experiment_scoped"
            },
            "audit_session_id": "20250824T195143Z_6667212c"
          }
        },
        "cached": true
      },
      {
        "analysis_id": "analysis_02c1cd5e194e",
        "result_hash": "030634c02c54c6243f0094976f89841167fc585b82b984e20f42e8a21d511167",
        "result_content": {
          "analysis_id": "analysis_02c1cd5e194e",
          "agent_name": "EnhancedAnalysisAgent",
          "agent_version": "enhanced_v2.1_raw_output",
          "experiment_name": "simple_test",
          "model_used": "vertex_ai/gemini-2.5-pro",
          "raw_analysis_response": "<<<DISCERNUS_ANALYSIS_JSON_v6>>>\n{\n  \"analysis_metadata\": {\n    \"framework_name\": \"cohesive_flourishing_framework\",\n    \"framework_version\": \"10.2\",\n    \"analyst_confidence\": 0.95,\n    \"analysis_notes\": \"The speaker employs a strong populist, class-based framing, creating a clear adversarial dynamic between 'working people' and a 'billionaire oligarchy'. This results in high scores on dimensions like Enmity, Envy, and Tribal Dominance (framed by class). Simultaneously, the speech makes strong appeals for in-group unity and universal dignity, leading to high scores in Amity and Individual Dignity. The rhetoric is a classic example of mobilizing a base by identifying a common enemy and a shared, protective goal.\"\n  },\n  \"document_analyses\": [\n    {\n      \"document_id\": \"{artifact_id}\",\n      \"document_name\": \"alexandria_ocasio_cortez_2025_fighting_oligarchy.txt\",\n      \"dimensional_scores\": {\n        \"tribal_dominance\": {\n          \"raw_score\": 0.7,\n          \"salience\": 0.8,\n          \"confidence\": 0.95\n        },\n        \"individual_dignity\": {\n          \"raw_score\": 0.8,\n          \"salience\": 0.7,\n          \"confidence\": 0.95\n        },\n        \"fear\": {\n          \"raw_score\": 0.8,\n          \"salience\": 0.8,\n          \"confidence\": 0.9\n        },\n        \"hope\": {\n          \"raw_score\": 0.4,\n          \"salience\": 0.4,\n          \"confidence\": 0.9\n        },\n        \"envy\": {\n          \"raw_score\": 0.9,\n          \"salience\": 0.9,\n          \"confidence\": 0.95\n        },\n        \"compersion\": {\n          \"raw_score\": 0.0,\n          \"salience\": 0.0,\n          \"confidence\": 1.0\n        },\n        \"enmity\": {\n          \"raw_score\": 0.9,\n          \"salience\": 0.9,\n          \"confidence\": 0.95\n        },\n        \"amity\": {\n          \"raw_score\": 0.8,\n          \"salience\": 0.8,\n          \"confidence\": 0.95\n        },\n        \"fragmentative_goals\": {\n          \"raw_score\": 0.7,\n          \"salience\": 0.6,\n          \"confidence\": 0.9\n        },\n        \"cohesive_goals\": {\n          \"raw_score\": 0.8,\n          \"salience\": 0.8,\n          \"confidence\": 0.95\n        }\n      },\n      \"evidence\": [\n        {\n          \"dimension\": \"tribal_dominance\",\n          \"quote_text\": \"The same billionaires are taking a wrecking ball to our country and they derive their power from dividing working people apart.\",\n          \"confidence\": 0.95,\n          \"context_type\": \"Adversarial framing\"\n        },\n        {\n          \"dimension\": \"individual_dignity\",\n          \"quote_text\": \"no matter who you voted for in the past. No matter if you know all the right words to say, no matter your race, religion, gender identity, or status... If you are willing to fight for someone you don\u2019t know, you are welcome here.\",\n          \"confidence\": 0.95,\n          \"context_type\": \"Inclusionary appeal\"\n        },\n        {\n          \"dimension\": \"fear\",\n          \"quote_text\": \"...the last thing they want us to realize is that the division that is actually hurting our country the most is how endless greed is costing the lives of everyone else.\",\n          \"confidence\": 0.9,\n          \"context_type\": \"Existential threat framing\"\n        },\n        {\n          \"dimension\": \"hope\",\n          \"quote_text\": \"Because in this house, we stand together, we know that, that it\u2019s our only choice because we know that without exception, if we stand together, it is the only way that we can win.\",\n          \"confidence\": 0.9,\n          \"context_type\": \"Call to action\"\n        },\n        {\n          \"dimension\": \"envy\",\n          \"quote_text\": \"Now it\u2019s this idea that if we just work hard, we too can have nation-state level money, except these kinds of spoils aren\u2019t earned really. They aren\u2019t working for these billions. They\u2019re stealing them.\",\n          \"confidence\": 0.95,\n          \"context_type\": \"Delegitimization of wealth\"\n        },\n        {\n          \"dimension\": \"compersion\",\n          \"quote_text\": \"\",\n          \"confidence\": 1.0,\n          \"context_type\": \"Absence of evidence\"\n        },\n        {\n          \"dimension\": \"enmity\",\n          \"quote_text\": \"We need to come together and spend every day between now and election day working to educate our neighbors, and give Evans and Boebert the boot, and replace them with a brawling Democrat who will stand for Colorado.\",\n          \"confidence\": 0.95,\n          \"context_type\": \"Targeted political opposition\"\n        },\n        {\n          \"dimension\": \"amity\",\n          \"quote_text\": \"If you are willing to fight for working people regardless of who they are, how they identify, or where they come from, you are welcome here.\",\n          \"confidence\": 0.95,\n          \"context_type\": \"Coalition building\"\n        },\n        {\n          \"dimension\": \"fragmentative_goals\",\n          \"quote_text\": \"his answer is an America that operates on the principle of every man for himself, divide and conquer.\",\n          \"confidence\": 0.9,\n          \"context_type\": \"Accusation of opponent's goals\"\n        },\n        {\n          \"dimension\": \"cohesive_goals\",\n          \"quote_text\": \"Because in this house, we stand together, we know that, that it\u2019s our only choice because we know that without exception, if we stand together, it is the only way that we can win.\",\n          \"confidence\": 0.95,\n          \"context_type\": \"Appeal for collective action\"\n        }\n      ]\n    }\n  ]\n}\n<<<END_DISCERNUS_ANALYSIS_JSON_v6>>>",
          "evidence_hash": "1b44a4878f8f8d6112610e99153032ae8ea87e42b5823af79125b99048a41389",
          "execution_metadata": {
            "start_time": "2025-08-24T21:05:06.206142+00:00",
            "end_time": "2025-08-24T21:05:53.821542+00:00",
            "duration_seconds": 47.61539
          },
          "input_artifacts": {
            "framework_hash": "aeaf6a196101d31208abb7400b7ca59b1cc0a25d2213f1ab236199a682797225",
            "document_hashes": [
              "1121e4ae679ce6e6c08c6d2d9aa4ce0c6e5040e8b13405fcfd9ea725b8ad5ff6"
            ],
            "num_documents": 1
          },
          "provenance": {
            "security_boundary": {
              "experiment_name": "simple_test_cff",
              "experiment_root": "/Volumes/code/discernus/projects/simple_test_cff",
              "boundary_type": "filesystem",
              "security_level": "experiment_scoped"
            },
            "audit_session_id": "20250824T195143Z_6667212c"
          }
        },
        "cached": true
      }
    ],
    "columns_added": []
  },
  "status": "success_with_data",
  "validation_passed": true
}