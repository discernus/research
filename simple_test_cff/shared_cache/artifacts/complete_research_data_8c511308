{
  "raw_analysis_results": [
    {
      "analysis_id": "analysis_088361cc0533",
      "result_hash": "f7e5bce529829b0033f2bd1e1379ad30278db6d75c2953ea7019e12db2ebf28b",
      "duration_seconds": 48.509691,
      "result_content": {
        "analysis_id": "analysis_088361cc0533",
        "agent_name": "EnhancedAnalysisAgent",
        "agent_version": "enhanced_v2.1_raw_output",
        "experiment_name": "simple_test",
        "model_used": "vertex_ai/gemini-2.5-pro",
        "raw_analysis_response": "<<<DISCERNUS_ANALYSIS_JSON_v6>>>\n{\n  \"analysis_metadata\": {\n    \"framework_name\": \"cohesive_flourishing_framework\",\n    \"framework_version\": \"10.2\",\n    \"analyst_confidence\": 0.98,\n    \"analysis_notes\": \"The document is a classic political concession speech, characterized by a strong emphasis on national unity and graciousness towards the victor. The analysis reflects this, with high scores on cohesive dimensions (Amity, Compersion, Cohesive Goals, Individual Dignity) and correspondingly low scores on divisive dimensions. The rhetoric is clear and serves as a strong example of discourse aimed at bridging divides post-election.\"\n  },\n  \"document_analyses\": [\n    {\n      \"document_id\": \"{artifact_id}\",\n      \"document_name\": \"john_mccain_2008_concession.txt\",\n      \"dimensional_scores\": {\n        \"tribal_dominance\": {\n          \"raw_score\": 0.0,\n          \"salience\": 0.1,\n          \"confidence\": 1.0\n        },\n        \"individual_dignity\": {\n          \"raw_score\": 0.8,\n          \"salience\": 0.9,\n          \"confidence\": 1.0\n        },\n        \"fear\": {\n          \"raw_score\": 0.2,\n          \"salience\": 0.3,\n          \"confidence\": 0.9\n        },\n        \"hope\": {\n          \"raw_score\": 0.7,\n          \"salience\": 0.7,\n          \"confidence\": 1.0\n        },\n        \"envy\": {\n          \"raw_score\": 0.0,\n          \"salience\": 0.0,\n          \"confidence\": 1.0\n        },\n        \"compersion\": {\n          \"raw_score\": 0.9,\n          \"salience\": 0.9,\n          \"confidence\": 1.0\n        },\n        \"enmity\": {\n          \"raw_score\": 0.0,\n          \"salience\": 0.1,\n          \"confidence\": 1.0\n        },\n        \"amity\": {\n          \"raw_score\": 0.9,\n          \"salience\": 0.9,\n          \"confidence\": 1.0\n        },\n        \"fragmentative_goals\": {\n          \"raw_score\": 0.0,\n          \"salience\": 0.0,\n          \"confidence\": 1.0\n        },\n        \"cohesive_goals\": {\n          \"raw_score\": 0.9,\n          \"salience\": 0.9,\n          \"confidence\": 1.0\n        }\n      },\n      \"evidence\": [\n        {\n          \"dimension\": \"tribal_dominance\",\n          \"quote_text\": \"\",\n          \"confidence\": 1.0,\n          \"context_type\": \"absence_of_dimension\"\n        },\n        {\n          \"dimension\": \"individual_dignity\",\n          \"quote_text\": \"This is an historic election, and I recognize the special significance it has for African-Americans and for the special pride that must be theirs tonight.\",\n          \"confidence\": 1.0,\n          \"context_type\": \"explicit_statement\"\n        },\n        {\n          \"dimension\": \"fear\",\n          \"quote_text\": \"These are difficult times for our country, and I pledge to him tonight to do all in my power to help him lead us through the many challenges we face.\",\n          \"confidence\": 0.9,\n          \"context_type\": \"contextual_framing\"\n        },\n        {\n          \"dimension\": \"hope\",\n          \"quote_text\": \"...to not despair of our present difficulties, but to believe always in the promise and greatness of America.\",\n          \"confidence\": 1.0,\n          \"context_type\": \"explicit_call_to_action\"\n        },\n        {\n          \"dimension\": \"envy\",\n          \"quote_text\": \"\",\n          \"confidence\": 1.0,\n          \"context_type\": \"absence_of_dimension\"\n        },\n        {\n          \"dimension\": \"compersion\",\n          \"quote_text\": \"But that he managed to do so by inspiring the hopes of so many millions of Americans who had once wrongly believed that they had little at stake or little influence in the election of an American president is something I deeply admire and commend him for achieving.\",\n          \"confidence\": 1.0,\n          \"context_type\": \"explicit_praise_of_opponent\"\n        },\n        {\n          \"dimension\": \"enmity\",\n          \"quote_text\": \"\",\n          \"confidence\": 1.0,\n          \"context_type\": \"absence_of_dimension\"\n        },\n        {\n          \"dimension\": \"amity\",\n          \"quote_text\": \"Whatever our differences, we are fellow Americans, and please believe me when I say no association has ever meant more to me than that.\",\n          \"confidence\": 1.0,\n          \"context_type\": \"explicit_statement\"\n        },\n        {\n          \"dimension\": \"fragmentative_goals\",\n          \"quote_text\": \"\",\n          \"confidence\": 1.0,\n          \"context_type\": \"absence_of_dimension\"\n        },\n        {\n          \"dimension\": \"cohesive_goals\",\n          \"quote_text\": \"I urge all Americans who supported me to join me in not just congratulating him, but offering our next president our good will and earnest effort to find ways to come together, to find the necessary compromises to bridge our differences...\",\n          \"confidence\": 1.0,\n          \"context_type\": \"explicit_call_to_action\"\n        }\n      ]\n    }\n  ]\n}\n<<<END_DISCERNUS_ANALYSIS_JSON_v6>>>",
        "evidence_hash": "0b9340b5e338fe925df3041374e611d4d88ff0e6626135f457c110b52d9c3cdd",
        "execution_metadata": {
          "start_time": "2025-08-29T15:46:43.935344+00:00",
          "end_time": "2025-08-29T15:47:32.445056+00:00",
          "duration_seconds": 48.509691
        },
        "input_artifacts": {
          "framework_hash": "77e927d6773a3131ec6b0fa5ef666cbcd957859357ebe6ae80efaeb7be557b12",
          "document_hashes": [
            "ff9b26f20ad6dfa10cbf8ce4b7353fddab5e7cce5879e6b4603b8af60d0a9e35"
          ],
          "num_documents": 1
        },
        "provenance": {
          "security_boundary": {
            "experiment_name": "simple_test_cff",
            "experiment_root": "/Volumes/code/discernus/projects/simple_test_cff",
            "boundary_type": "filesystem",
            "security_level": "experiment_scoped"
          },
          "audit_session_id": "20250829T154643Z_5c1e6644"
        }
      }
    },
    {
      "analysis_id": "analysis_5039147acdd4",
      "result_hash": "9feeb61943a14fd7e3332f9f28f2584d4cc0f020704499cb3a3d823de83da2bf",
      "duration_seconds": 46.672486,
      "result_content": {
        "analysis_id": "analysis_5039147acdd4",
        "agent_name": "EnhancedAnalysisAgent",
        "agent_version": "enhanced_v2.1_raw_output",
        "experiment_name": "simple_test",
        "model_used": "vertex_ai/gemini-2.5-pro",
        "raw_analysis_response": "<<<DISCERNUS_ANALYSIS_JSON_v6>>>\n{\n  \"analysis_metadata\": {\n    \"framework_name\": \"cohesive_flourishing_framework\",\n    \"framework_version\": \"10.2\",\n    \"analyst_confidence\": 0.95,\n    \"analysis_notes\": \"The document is a political speech characterized by strong, unambiguous rhetoric. The dominant dimensions of Fear, Enmity, and Tribal Dominance are exceptionally clear and well-evidenced, making confidence in their scoring very high. Conversely, the cohesive dimensions (Amity, Compersion, Cohesive Goals) are almost entirely absent, which is also scored with high confidence. The analysis focuses on the explicit rhetorical strategies and emotionally charged narratives used throughout the speech.\"\n  },\n  \"document_analyses\": [\n    {\n      \"document_id\": \"{artifact_id}\",\n      \"document_name\": \"steve_king_2017_house_floor.txt\",\n      \"dimensional_scores\": {\n        \"tribal_dominance\": {\n          \"raw_score\": 0.85,\n          \"salience\": 0.9,\n          \"confidence\": 0.95\n        },\n        \"individual_dignity\": {\n          \"raw_score\": 0.1,\n          \"salience\": 0.1,\n          \"confidence\": 0.9\n        },\n        \"fear\": {\n          \"raw_score\": 0.9,\n          \"salience\": 0.9,\n          \"confidence\": 1.0\n        },\n        \"hope\": {\n          \"raw_score\": 0.2,\n          \"salience\": 0.2,\n          \"confidence\": 0.9\n        },\n        \"envy\": {\n          \"raw_score\": 0.6,\n          \"salience\": 0.5,\n          \"confidence\": 0.85\n        },\n        \"compersion\": {\n          \"raw_score\": 0.0,\n          \"salience\": 0.0,\n          \"confidence\": 1.0\n        },\n        \"enmity\": {\n          \"raw_score\": 0.9,\n          \"salience\": 0.95,\n          \"confidence\": 1.0\n        },\n        \"amity\": {\n          \"raw_score\": 0.0,\n          \"salience\": 0.0,\n          \"confidence\": 1.0\n        },\n        \"fragmentative_goals\": {\n          \"raw_score\": 0.8,\n          \"salience\": 0.8,\n          \"confidence\": 0.95\n        },\n        \"cohesive_goals\": {\n          \"raw_score\": 0.1,\n          \"salience\": 0.2,\n          \"confidence\": 0.8\n        }\n      },\n      \"evidence\": [\n        {\n          \"dimension\": \"tribal_dominance\",\n          \"quote_text\": \"to push Obamacare down the throats of the American people.\",\n          \"confidence\": 0.95,\n          \"context_type\": \"in-group/out-group framing\"\n        },\n        {\n          \"dimension\": \"individual_dignity\",\n          \"quote_text\": \"That being one of God's children is good enough to be protected by the law, but everybody treated equally.\",\n          \"confidence\": 0.7,\n          \"context_type\": \"isolated appeal to universal principle\"\n        },\n        {\n          \"dimension\": \"fear\",\n          \"quote_text\": \"Sarah Root would be alive today if the President had done his job, if law enforcement had been allowed to do their job, if ICE had responded when local law enforcement called them.\",\n          \"confidence\": 1.0,\n          \"context_type\": \"existential threat perception\"\n        },\n        {\n          \"dimension\": \"hope\",\n          \"quote_text\": \"This is the time we must defend our Constitution and we must nominate and elect a president of the United States who will make those appointments to the Supreme Court who believe the Constitution means what it says.\",\n          \"confidence\": 0.9,\n          \"context_type\": \"conditional vision of restoration\"\n        },\n        {\n          \"dimension\": \"envy\",\n          \"quote_text\": \"The Chief Justice of the Supreme Court decided that he could write words into Obamacare that didn\u2019t exist... They made it up.\",\n          \"confidence\": 0.9,\n          \"context_type\": \"grievance over illegitimate power\"\n        },\n        {\n          \"dimension\": \"compersion\",\n          \"quote_text\": \"\",\n          \"confidence\": 1.0,\n          \"context_type\": \"absent dimension\"\n        },\n        {\n          \"dimension\": \"enmity\",\n          \"quote_text\": \"This is the face of one of these perpetrators, Mauricio Hernandez. What did he do? Mauricio Hernandez, a sexual predator who impregnated a 13-year-old daughter of his living girlfriend.\",\n          \"confidence\": 1.0,\n          \"context_type\": \"adversarial characterization\"\n        },\n        {\n          \"dimension\": \"amity\",\n          \"quote_text\": \"\",\n          \"confidence\": 1.0,\n          \"context_type\": \"absent dimension\"\n        },\n        {\n          \"dimension\": \"fragmentative_goals\",\n          \"quote_text\": \"No hearing, no, no confirmation in the Senate, no vote in the in the Judiciary Committee, and no vote on the floor of the Senate for this lame duck President's appointments because we have a Constitution that's got to be restored.\",\n          \"confidence\": 1.0,\n          \"context_type\": \"explicit zero-sum objective\"\n        },\n        {\n          \"dimension\": \"cohesive_goals\",\n          \"quote_text\": \"Secure our borders. Restore their respect for the rule of law. Save these lives.\",\n          \"confidence\": 0.8,\n          \"context_type\": \"goal framed as restoration and enforcement\"\n        }\n      ]\n    }\n  ]\n}\n<<<END_DISCERNUS_ANALYSIS_JSON_v6>>>",
        "evidence_hash": "ab865aa2399ab2a230aecba1c9f8016094bbbba504cb016b117f5b8ac74d6baf",
        "execution_metadata": {
          "start_time": "2025-08-29T15:47:32.448893+00:00",
          "end_time": "2025-08-29T15:48:19.121389+00:00",
          "duration_seconds": 46.672486
        },
        "input_artifacts": {
          "framework_hash": "77e927d6773a3131ec6b0fa5ef666cbcd957859357ebe6ae80efaeb7be557b12",
          "document_hashes": [
            "738780d93cc3c43b7b2e292a7fd0aa9f7e438f7ad2555be4ce6bfc20d9efda82"
          ],
          "num_documents": 1
        },
        "provenance": {
          "security_boundary": {
            "experiment_name": "simple_test_cff",
            "experiment_root": "/Volumes/code/discernus/projects/simple_test_cff",
            "boundary_type": "filesystem",
            "security_level": "experiment_scoped"
          },
          "audit_session_id": "20250829T154643Z_5c1e6644"
        }
      }
    },
    {
      "analysis_id": "analysis_e183eef92a4d",
      "result_hash": "a8d54c783b5cb705aa13c22a8f839bdb358bb14ff727f1d2639d181e1f92a065",
      "duration_seconds": 46.899221,
      "result_content": {
        "analysis_id": "analysis_e183eef92a4d",
        "agent_name": "EnhancedAnalysisAgent",
        "agent_version": "enhanced_v2.1_raw_output",
        "experiment_name": "simple_test",
        "model_used": "vertex_ai/gemini-2.5-pro",
        "raw_analysis_response": "<<<DISCERNUS_ANALYSIS_JSON_v6>>>\n{\n  \"analysis_metadata\": {\n    \"framework_name\": \"cohesive_flourishing_framework\",\n    \"framework_version\": \"10.2\",\n    \"analyst_confidence\": 0.95,\n    \"analysis_notes\": \"Analysis based on the 'default' variant. The document is a clear example of populist economic rhetoric, characterized by a strong in-group ('the people') vs. out-group ('oligarchs') framing. This leads to high scores in dimensions like Enmity, Envy, and Tribal Dominance. Cohesive elements like Hope and Amity are present but framed as tools for in-group mobilization against the out-group.\"\n  },\n  \"document_analyses\": [\n    {\n      \"document_id\": \"{artifact_id}\",\n      \"document_name\": \"bernie_sanders_2025_fighting_oligarchy.txt\",\n      \"dimensional_scores\": {\n        \"tribal_dominance\": {\n          \"raw_score\": 0.7,\n          \"salience\": 0.9,\n          \"confidence\": 0.95\n        },\n        \"individual_dignity\": {\n          \"raw_score\": 0.2,\n          \"salience\": 0.1,\n          \"confidence\": 0.8\n        },\n        \"fear\": {\n          \"raw_score\": 0.8,\n          \"salience\": 0.8,\n          \"confidence\": 0.95\n        },\n        \"hope\": {\n          \"raw_score\": 0.6,\n          \"salience\": 0.4,\n          \"confidence\": 0.9\n        },\n        \"envy\": {\n          \"raw_score\": 0.9,\n          \"salience\": 0.9,\n          \"confidence\": 0.95\n        },\n        \"compersion\": {\n          \"raw_score\": 0.0,\n          \"salience\": 0.0,\n          \"confidence\": 1.0\n        },\n        \"enmity\": {\n          \"raw_score\": 0.9,\n          \"salience\": 0.9,\n          \"confidence\": 0.95\n        },\n        \"amity\": {\n          \"raw_score\": 0.5,\n          \"salience\": 0.5,\n          \"confidence\": 0.9\n        },\n        \"fragmentative_goals\": {\n          \"raw_score\": 0.8,\n          \"salience\": 0.8,\n          \"confidence\": 0.95\n        },\n        \"cohesive_goals\": {\n          \"raw_score\": 0.5,\n          \"salience\": 0.4,\n          \"confidence\": 0.9\n        }\n      },\n      \"evidence\": [\n        {\n          \"dimension\": \"tribal_dominance\",\n          \"quote_text\": \"Abraham Lincoln talked about a government of the people, by the people, for the people. Well, Trump has a government of the billionaires, by the billionaires, and for the billionaires.\",\n          \"confidence\": 0.95,\n          \"context_type\": \"rhetorical_contrast\"\n        },\n        {\n          \"dimension\": \"individual_dignity\",\n          \"quote_text\": \"...we can create the kind of nation that we deserve.\",\n          \"confidence\": 0.7,\n          \"context_type\": \"concluding_statement\"\n        },\n        {\n          \"dimension\": \"fear\",\n          \"quote_text\": \"They are prepared to destroy Social Security, Medicaid, Medicare, the Veterans Administration in order to make themselves even richer.\",\n          \"confidence\": 1.0,\n          \"context_type\": \"accusation_of_threat\"\n        },\n        {\n          \"dimension\": \"hope\",\n          \"quote_text\": \"So if we stand together, are strong, are disciplined, are smart, I have every reason to believe deeply in my heart that not only will we defeat Trumpism, but we can create the kind of nation that we deserve.\",\n          \"confidence\": 0.95,\n          \"context_type\": \"call_to_action\"\n        },\n        {\n          \"dimension\": \"envy\",\n          \"quote_text\": \"Meanwhile, there has been a $75 trillion transfer of wealth from the bottom 90% to the top 1%. That is what a rigged economy is about, and that is what we are going to change.\",\n          \"confidence\": 1.0,\n          \"context_type\": \"zero_sum_framing\"\n        },\n        {\n          \"dimension\": \"compersion\",\n          \"quote_text\": \"\",\n          \"confidence\": 1.0,\n          \"context_type\": \"absence_of_evidence\"\n        },\n        {\n          \"dimension\": \"enmity\",\n          \"quote_text\": \"But I will tell you this, in the midst of all of these addictions, the worst and most dangerous addiction we have is the greed of the oligarchs.\",\n          \"confidence\": 1.0,\n          \"context_type\": \"character_assassination\"\n        },\n        {\n          \"dimension\": \"amity\",\n          \"quote_text\": \"So if we stand together, are strong, are disciplined, are smart, I have every reason to believe deeply in my heart that not only will we defeat Trumpism, but we can create the kind of nation that we deserve.\",\n          \"confidence\": 0.9,\n          \"context_type\": \"in_group_solidarity_appeal\"\n        },\n        {\n          \"dimension\": \"fragmentative_goals\",\n          \"quote_text\": \"That is what a rigged economy is about, and that is what we are going to change.\",\n          \"confidence\": 0.95,\n          \"context_type\": \"statement_of_objective\"\n        },\n        {\n          \"dimension\": \"cohesive_goals\",\n          \"quote_text\": \"...not only will we defeat Trumpism, but we can create the kind of nation that we deserve.\",\n          \"confidence\": 0.9,\n          \"context_type\": \"statement_of_vision\"\n        }\n      ]\n    }\n  ]\n}\n<<<END_DISCERNUS_ANALYSIS_JSON_v6>>>",
        "evidence_hash": "8d7b38cdad5ed82af092f4fe397ff22acde5c189213364785ad87e9e0f82f6f1",
        "execution_metadata": {
          "start_time": "2025-08-29T15:48:19.122251+00:00",
          "end_time": "2025-08-29T15:49:06.021481+00:00",
          "duration_seconds": 46.899221
        },
        "input_artifacts": {
          "framework_hash": "77e927d6773a3131ec6b0fa5ef666cbcd957859357ebe6ae80efaeb7be557b12",
          "document_hashes": [
            "261b893a384411f76907e78e7997860cd9be5d959334a6b9ae1386ea1ba6cbdd"
          ],
          "num_documents": 1
        },
        "provenance": {
          "security_boundary": {
            "experiment_name": "simple_test_cff",
            "experiment_root": "/Volumes/code/discernus/projects/simple_test_cff",
            "boundary_type": "filesystem",
            "security_level": "experiment_scoped"
          },
          "audit_session_id": "20250829T154643Z_5c1e6644"
        }
      }
    },
    {
      "analysis_id": "analysis_648630eae46a",
      "result_hash": "64ee764a21af6c63a272bd5bd617e65e3db509fbda6395a1312bf036a8cd8ddb",
      "duration_seconds": 57.766415,
      "result_content": {
        "analysis_id": "analysis_648630eae46a",
        "agent_name": "EnhancedAnalysisAgent",
        "agent_version": "enhanced_v2.1_raw_output",
        "experiment_name": "simple_test",
        "model_used": "vertex_ai/gemini-2.5-pro",
        "raw_analysis_response": "<<<DISCERNUS_ANALYSIS_JSON_v6>>>\n{\n  \"analysis_metadata\": {\n    \"framework_name\": \"cohesive_flourishing_framework\",\n    \"framework_version\": \"10.2\",\n    \"analyst_confidence\": 0.9,\n    \"analysis_notes\": \"The analysis focuses on the speaker's rhetorical construction of a class-based conflict. The speech strongly delineates an 'in-group' (the working class) and an 'out-group' (the oligarchy), attributing malicious intent and illegitimate success to the latter. The primary rhetorical strategy is to foster in-group solidarity (Amity, Cohesive Goals) to fight an external enemy (Enmity, Fragmentative Goals).\"\n  },\n  \"document_analyses\": [\n    {\n      \"document_id\": \"{artifact_id}\",\n      \"document_name\": \"alexandria_ocasio_cortez_2025_fighting_oligarchy.txt\",\n      \"dimensional_scores\": {\n        \"tribal_dominance\": {\n          \"raw_score\": 0.7,\n          \"salience\": 0.8,\n          \"confidence\": 0.9\n        },\n        \"individual_dignity\": {\n          \"raw_score\": 0.8,\n          \"salience\": 0.7,\n          \"confidence\": 0.95\n        },\n        \"fear\": {\n          \"raw_score\": 0.8,\n          \"salience\": 0.8,\n          \"confidence\": 0.9\n        },\n        \"hope\": {\n          \"raw_score\": 0.5,\n          \"salience\": 0.5,\n          \"confidence\": 0.85\n        },\n        \"envy\": {\n          \"raw_score\": 0.9,\n          \"salience\": 0.9,\n          \"confidence\": 1.0\n        },\n        \"compersion\": {\n          \"raw_score\": 0.0,\n          \"salience\": 0.0,\n          \"confidence\": 1.0\n        },\n        \"enmity\": {\n          \"raw_score\": 0.9,\n          \"salience\": 0.9,\n          \"confidence\": 1.0\n        },\n        \"amity\": {\n          \"raw_score\": 0.8,\n          \"salience\": 0.8,\n          \"confidence\": 0.95\n        },\n        \"fragmentative_goals\": {\n          \"raw_score\": 0.8,\n          \"salience\": 0.8,\n          \"confidence\": 0.9\n        },\n        \"cohesive_goals\": {\n          \"raw_score\": 0.8,\n          \"salience\": 0.8,\n          \"confidence\": 0.95\n        }\n      },\n      \"evidence\": [\n        {\n          \"dimension\": \"tribal_dominance\",\n          \"quote_text\": \"The same billionaires are taking a wrecking ball to our country and they derive their power from dividing working people apart.\",\n          \"confidence\": 0.9,\n          \"context_type\": \"characterization_of_outgroup\"\n        },\n        {\n          \"dimension\": \"individual_dignity\",\n          \"quote_text\": \"If you are willing to fight for someone you don\u2019t know, you are welcome here.\",\n          \"confidence\": 0.95,\n          \"context_type\": \"statement_of_inclusive_values\"\n        },\n        {\n          \"dimension\": \"fear\",\n          \"quote_text\": \"And our political system is ill-prepared for this abuse of power. In fact, much of our political system enables it, starting with the role of money in politics.\",\n          \"confidence\": 0.9,\n          \"context_type\": \"description_of_systemic_threat\"\n        },\n        {\n          \"dimension\": \"hope\",\n          \"quote_text\": \"Because in this house, we stand together, we know that, that it's our only choice because we know that without exception, if we stand together, it is the only way that we can win.\",\n          \"confidence\": 0.9,\n          \"context_type\": \"statement_of_conditional_optimism\"\n        },\n        {\n          \"dimension\": \"envy\",\n          \"quote_text\": \"Now it's this idea that if we just work hard, we too can have nation-state level money, except these kinds of spoils aren\u2019t earned really. They aren't working for these billions. They're stealing them. They're stealing them. They're stealing them from you and you and me.\",\n          \"confidence\": 1.0,\n          \"context_type\": \"delegitimization_of_outgroup_success\"\n        },\n        {\n          \"dimension\": \"compersion\",\n          \"quote_text\": \"\",\n          \"confidence\": 1.0,\n          \"context_type\": \"absence_of_evidence\"\n        },\n        {\n          \"dimension\": \"enmity\",\n          \"quote_text\": \"We need to come together and spend every day between now and election day working to educate our neighbors, and give Evans and Boebert the boot, and replace them with a brawling Democrat who will stand for Colorado.\",\n          \"confidence\": 1.0,\n          \"context_type\": \"adversarial_call_to_action\"\n        },\n        {\n          \"dimension\": \"amity\",\n          \"quote_text\": \"Because in this house, we stand together, we know that, that it's our only choice because we know that without exception, if we stand together, it is the only way that we can win.\",\n          \"confidence\": 0.95,\n          \"context_type\": \"call_for_in-group_solidarity\"\n        },\n        {\n          \"dimension\": \"fragmentative_goals\",\n          \"quote_text\": \"Donald Trump does see the immense pressure that working people are under. But his answer is an America that operates on the principle of every man for himself, divide and conquer.\",\n          \"confidence\": 0.9,\n          \"context_type\": \"attribution_of_divisive_goals_to_opponent\"\n        },\n        {\n          \"dimension\": \"cohesive_goals\",\n          \"quote_text\": \"So I hope that you see this movement is not about partisan labels or purity tests, but about class solidarity.\",\n          \"confidence\": 1.0,\n          \"context_type\": \"explicit_statement_of_unifying_goal\"\n        }\n      ]\n    }\n  ]\n}\n<<<END_DISCERNUS_ANALYSIS_JSON_v6>>>",
        "evidence_hash": "791961db7154e75bcc838bb36e036666bd8924f552207bcee7f4f336187c9c2b",
        "execution_metadata": {
          "start_time": "2025-08-29T15:49:06.022342+00:00",
          "end_time": "2025-08-29T15:50:03.788777+00:00",
          "duration_seconds": 57.766415
        },
        "input_artifacts": {
          "framework_hash": "77e927d6773a3131ec6b0fa5ef666cbcd957859357ebe6ae80efaeb7be557b12",
          "document_hashes": [
            "1121e4ae679ce6e6c08c6d2d9aa4ce0c6e5040e8b13405fcfd9ea725b8ad5ff6"
          ],
          "num_documents": 1
        },
        "provenance": {
          "security_boundary": {
            "experiment_name": "simple_test_cff",
            "experiment_root": "/Volumes/code/discernus/projects/simple_test_cff",
            "boundary_type": "filesystem",
            "security_level": "experiment_scoped"
          },
          "audit_session_id": "20250829T154643Z_5c1e6644"
        }
      }
    }
  ],
  "derived_metrics_results": {
    "status": "completed",
    "derived_metrics_hash": "262c8e26e82648f17ec92a00ae45a82809d8006c676f7c957d800009d9753758",
    "functions_generated": 6,
    "derived_metrics_results": {
      "generation_metadata": {
        "status": "success",
        "functions_generated": 6,
        "output_file": "automatedderivedmetricsagent_functions.py",
        "module_size": 12197,
        "function_code_content": "\"\"\"\nAutomated Derived Metrics Functions\n===================================\n\nGenerated by AutomatedDerivedMetricsAgent for experiment: Test Experiment\nDescription: Test experiment for derived metrics\nGenerated: 2025-08-29T15:33:41.219149+00:00\n\nThis module contains automatically generated calculation functions for derived metrics\nas specified in the framework's natural language descriptions.\n\"\"\"\n\nimport pandas as pd\nimport numpy as np\nfrom typing import Optional, Dict, Any\n\n\ndef calculate_identity_tension(data, **kwargs):\n    \"\"\"\n    Calculate identity_tension: Conflict between tribal dominance and individual dignity dimensions.\n\n    This tension is modeled as the interaction between the 'tribal_dominance' and\n    'individual_dignity' dimensions. The conflict is considered highest when both\n    dimensions are strongly present in the discourse. The product of the scores\n    is used to represent this interaction.\n\n    Formula:\n    identity_tension = tribal_dominance * individual_dignity\n\n    Args:\n        data (pd.Series): A single row of data as a pandas Series, containing\n                          dimension scores.\n        **kwargs: Additional keyword arguments (not used).\n\n    Returns:\n        float: The calculated identity tension score, or None if input data is\n               missing or invalid.\n    \"\"\"\n    import pandas as pd\n    import numpy as np\n\n    try:\n        # This calculation logically requires 'tribal_dominance' and 'individual_dignity'\n        # columns, inferred from the calculation's description.\n        tribal_dominance = data['tribal_dominance']\n        individual_dignity = data['individual_dignity']\n\n        # Ensure both required values are present and are numeric\n        if pd.isna(tribal_dominance) or pd.isna(individual_dignity):\n            return None\n\n        # Calculate tension as the product of the two scores\n        result = float(tribal_dominance * individual_dignity)\n\n        # Ensure result is not NaN or infinite\n        if not np.isfinite(result):\n            return None\n            \n        return result\n\n    except (KeyError, TypeError, IndexError):\n        # Handles missing columns, non-numeric data, or empty data structures\n        return None\n    except Exception:\n        # Fallback for any other unexpected errors\n        return None\n\ndef calculate_emotional_balance(data, **kwargs):\n    \"\"\"\n    Calculate emotional_balance: Difference between hope and fear scores.\n\n    Formula: hope - fear\n\n    Args:\n        data (pd.Series): A single row of data containing dimension scores.\n        **kwargs: Additional keyword arguments (not used).\n\n    Returns:\n        float: The calculated emotional balance, or None if 'hope' or 'fear'\n               scores are missing, non-numeric, or contain NaN values.\n    \"\"\"\n    import pandas as pd\n    import numpy as np\n\n    try:\n        # Access the required scores from the data row (Series).\n        # A KeyError will be raised if the 'hope' or 'fear' columns are missing.\n        hope_score = data['hope']\n        fear_score = data['fear']\n\n        # The subtraction operation will result in NaN if either input is NaN.\n        # A TypeError will be raised if the dtypes are incompatible (e.g., string).\n        result = hope_score - fear_score\n\n        # A final check for NaN is the most robust way to handle missing inputs.\n        if pd.isna(result):\n            return None\n        else:\n            return float(result)\n\n    except (KeyError, TypeError):\n        # If required columns are missing or data is of the wrong type,\n        # the calculation cannot be performed.\n        return None\n\ndef calculate_success_climate(data, **kwargs):\n    \"\"\"\n    Calculate success_climate: Difference between compersion and envy scores.\n\n    Formula: compersion - envy\n\n    Args:\n        data (pd.Series): A single row of data represented as a pandas Series.\n                          This Series must contain 'compersion' and 'envy' scores.\n        **kwargs: Additional keyword arguments (not used).\n\n    Returns:\n        float: The calculated score, or None if the required data is missing or invalid.\n    \"\"\"\n    import pandas as pd\n\n    try:\n        # The calculation requires 'compersion' and 'envy' scores.\n        compersion_score = data['compersion']\n        envy_score = data['envy']\n\n        # Check if either score is a missing value (e.g., NaN).\n        if pd.isna(compersion_score) or pd.isna(envy_score):\n            return None\n\n        # Perform the calculation and ensure the result is a float.\n        result = float(compersion_score) - float(envy_score)\n\n        return result\n\n    except (KeyError, TypeError, ValueError):\n        # KeyError: If 'compersion' or 'envy' columns are not in the data.\n        # TypeError/ValueError: If scores are not numeric and cannot be cast to float.\n        return None\n\ndef calculate_relational_climate(data, **kwargs):\n    \"\"\"\n    Calculate relational_climate: Difference between amity and enmity scores\n\n    Formula: amity - enmity\n\n    Args:\n        data (pd.Series): A row of data containing dimension scores.\n        **kwargs: Additional keyword arguments (unused).\n\n    Returns:\n        float: The calculated relational climate score, or None if the necessary\n               'amity' or 'enmity' columns are missing or contain non-numeric data.\n    \"\"\"\n    import pandas as pd\n    import numpy as np\n\n    try:\n        # The calculation requires 'amity' and 'enmity' scores.\n        # This function assumes these columns exist in the input 'data' object.\n        amity_score = pd.to_numeric(data['amity'], errors='coerce')\n        enmity_score = pd.to_numeric(data['enmity'], errors='coerce')\n\n        # If either score could not be converted to a number (i.e., is NaN),\n        # there is insufficient data to perform the calculation.\n        if pd.isna(amity_score) or pd.isna(enmity_score):\n            return None\n\n        # Calculate the difference as per the definition.\n        relational_climate = amity_score - enmity_score\n\n        return float(relational_climate)\n\n    except (KeyError, TypeError, AttributeError):\n        # KeyError: Handles cases where 'amity' or 'enmity' columns do not exist.\n        # TypeError/AttributeError: Handles cases where 'data' is not a dict-like object.\n        return None\n\ndef calculate_goal_orientation(data, **kwargs):\n    \"\"\"\n    Calculate goal_orientation: Difference between cohesive goals and fragmentative goals\n\n    Formula: cohesive_goals - fragmentative_goals\n    \n    Args:\n        data (pd.Series): A single row of data from the DataFrame.\n        **kwargs: Additional parameters (unused).\n        \n    Returns:\n        float: The calculated goal orientation score, or None if input data is missing or invalid.\n    \"\"\"\n    import pandas as pd\n    import numpy as np\n    \n    try:\n        # The calculation is defined by the framework as the difference between\n        # 'cohesive_goals' and 'fragmentative_goals' scores.\n        cohesive_score = data['cohesive_goals']\n        fragmentative_score = data['fragmentative_goals']\n        \n        # Handle cases where either of the required scores is missing.\n        if pd.isna(cohesive_score) or pd.isna(fragmentative_score):\n            return None\n            \n        # Ensure values are numeric and perform the calculation.\n        result = float(cohesive_score) - float(fragmentative_score)\n        \n        # Return None if the result is not a finite number (e.g., inf, -inf, nan)\n        if not np.isfinite(result):\n            return None\n            \n        return result\n        \n    except (KeyError, TypeError, ValueError):\n        # KeyError: Catches cases where the required columns are not in the data.\n        # This is expected if the provided data structure doesn't match the calculation's needs.\n        # TypeError/ValueError: Catches cases where data is not in a numeric format.\n        return None\n\ndef calculate_overall_cohesion_index(data, **kwargs):\n    \"\"\"\n    Calculate overall_cohesion_index: Comprehensive measure combining all dimensions.\n\n    This function is designed to compute a comprehensive score reflecting overall\n    social cohesion. The conceptual formula involves aggregating multiple\n    individual dimension scores from the Cohesive Flourishing Framework.\n\n    Formula: Conceptually, an aggregation (e.g., weighted average) of various\n    cohesion dimension scores. Since the specific dimension score columns are not\n    present in the provided data structure, this calculation cannot be performed.\n\n    Args:\n        data (pd.Series): A single row of data represented as a pandas Series.\n                          It is expected to contain various dimension scores for\n                          the calculation.\n        **kwargs: Additional keyword arguments (not used in this implementation).\n\n    Returns:\n        float: The calculated index. Returns None because the necessary dimension\n               score columns are not available in the input data structure,\n               preventing the calculation.\n    \"\"\"\n    import pandas as pd\n    import numpy as np\n\n    try:\n        # The calculation for 'overall_cohesion_index' is described as a\n        # \"Comprehensive measure combining all dimensions\". This requires specific\n        # dimension score columns (e.g., scores for Hope, Fear, Unity, etc.)\n        # which are part of the Cohesive Flourishing Framework.\n\n        # The provided data structure only contains the following columns:\n        # 'analysis_result', 'raw_analysis_response', 'scores_hash',\n        # 'evidence_hash', 'document_id', 'filename'.\n\n        # As per the explicit instructions, column names cannot be assumed or invented.\n        # Since the necessary input dimensions for the calculation are not present\n        # in the 'data' object, it is impossible to compute the index.\n\n        # The function gracefully handles this by returning None, indicating that\n        # the calculation could not be completed due to missing prerequisite data.\n        return None\n\n    except Exception:\n        # This broad exception handler ensures robustness. If any unexpected error\n        # occurs during processing (e.g., due to malformed data), the function\n        # will return None instead of crashing.\n        return None\n\ndef calculate_all_derived_metrics(data: pd.DataFrame) -> Dict[str, Optional[float]]:\n    \"\"\"\n    Calculate all derived metrics for the given dataset.\n    \n    Args:\n        data: pandas DataFrame with dimension scores\n        \n    Returns:\n        Dictionary mapping metric names to calculated values\n    \"\"\"\n    results = {}\n    \n    # Get all calculation functions from this module\n    import inspect\n    current_module = inspect.getmodule(inspect.currentframe())\n    \n    for name, obj in inspect.getmembers(current_module):\n        if (inspect.isfunction(obj) and \n            name.startswith('calculate_') and \n            name not in ['calculate_all_derived_metrics', 'calculate_derived_metrics']):\n            try:\n                results[name.replace('calculate_', '')] = obj(data)\n            except Exception as e:\n                results[name.replace('calculate_', '')] = None\n                \n    return results\n\n\ndef calculate_derived_metrics(data: pd.DataFrame) -> pd.DataFrame:\n    \"\"\"\n    Template-compatible wrapper function for derived metrics calculation.\n    \n    This function is called by the universal notebook template and returns\n    the original data with additional derived metric columns.\n    \n    Args:\n        data: pandas DataFrame with dimension scores\n        \n    Returns:\n        DataFrame with original data plus derived metric columns\n    \"\"\"\n    # Calculate all derived metrics\n    derived_metrics = calculate_all_derived_metrics(data)\n    \n    # Create a copy of the original data\n    result = data.copy()\n    \n    # Add derived metrics as new columns\n    for metric_name, metric_value in derived_metrics.items():\n        if metric_value is not None:\n            # For scalar metrics, broadcast to all rows\n            result[metric_name] = metric_value\n        else:\n            # For failed calculations, use NaN\n            result[metric_name] = np.nan\n    \n    return result\n",
        "cached_with_code": true
      },
      "derived_metrics_data": {
        "status": "success",
        "original_count": 4,
        "derived_count": 4,
        "derived_metrics": [
          {
            "analysis_id": "analysis_088361cc0533",
            "result_hash": "f7e5bce529829b0033f2bd1e1379ad30278db6d75c2953ea7019e12db2ebf28b",
            "duration_seconds": 48.509691,
            "result_content": {
              "analysis_id": "analysis_088361cc0533",
              "agent_name": "EnhancedAnalysisAgent",
              "agent_version": "enhanced_v2.1_raw_output",
              "experiment_name": "simple_test",
              "model_used": "vertex_ai/gemini-2.5-pro",
              "raw_analysis_response": "<<<DISCERNUS_ANALYSIS_JSON_v6>>>\n{\n  \"analysis_metadata\": {\n    \"framework_name\": \"cohesive_flourishing_framework\",\n    \"framework_version\": \"10.2\",\n    \"analyst_confidence\": 0.98,\n    \"analysis_notes\": \"The document is a classic political concession speech, characterized by a strong emphasis on national unity and graciousness towards the victor. The analysis reflects this, with high scores on cohesive dimensions (Amity, Compersion, Cohesive Goals, Individual Dignity) and correspondingly low scores on divisive dimensions. The rhetoric is clear and serves as a strong example of discourse aimed at bridging divides post-election.\"\n  },\n  \"document_analyses\": [\n    {\n      \"document_id\": \"{artifact_id}\",\n      \"document_name\": \"john_mccain_2008_concession.txt\",\n      \"dimensional_scores\": {\n        \"tribal_dominance\": {\n          \"raw_score\": 0.0,\n          \"salience\": 0.1,\n          \"confidence\": 1.0\n        },\n        \"individual_dignity\": {\n          \"raw_score\": 0.8,\n          \"salience\": 0.9,\n          \"confidence\": 1.0\n        },\n        \"fear\": {\n          \"raw_score\": 0.2,\n          \"salience\": 0.3,\n          \"confidence\": 0.9\n        },\n        \"hope\": {\n          \"raw_score\": 0.7,\n          \"salience\": 0.7,\n          \"confidence\": 1.0\n        },\n        \"envy\": {\n          \"raw_score\": 0.0,\n          \"salience\": 0.0,\n          \"confidence\": 1.0\n        },\n        \"compersion\": {\n          \"raw_score\": 0.9,\n          \"salience\": 0.9,\n          \"confidence\": 1.0\n        },\n        \"enmity\": {\n          \"raw_score\": 0.0,\n          \"salience\": 0.1,\n          \"confidence\": 1.0\n        },\n        \"amity\": {\n          \"raw_score\": 0.9,\n          \"salience\": 0.9,\n          \"confidence\": 1.0\n        },\n        \"fragmentative_goals\": {\n          \"raw_score\": 0.0,\n          \"salience\": 0.0,\n          \"confidence\": 1.0\n        },\n        \"cohesive_goals\": {\n          \"raw_score\": 0.9,\n          \"salience\": 0.9,\n          \"confidence\": 1.0\n        }\n      },\n      \"evidence\": [\n        {\n          \"dimension\": \"tribal_dominance\",\n          \"quote_text\": \"\",\n          \"confidence\": 1.0,\n          \"context_type\": \"absence_of_dimension\"\n        },\n        {\n          \"dimension\": \"individual_dignity\",\n          \"quote_text\": \"This is an historic election, and I recognize the special significance it has for African-Americans and for the special pride that must be theirs tonight.\",\n          \"confidence\": 1.0,\n          \"context_type\": \"explicit_statement\"\n        },\n        {\n          \"dimension\": \"fear\",\n          \"quote_text\": \"These are difficult times for our country, and I pledge to him tonight to do all in my power to help him lead us through the many challenges we face.\",\n          \"confidence\": 0.9,\n          \"context_type\": \"contextual_framing\"\n        },\n        {\n          \"dimension\": \"hope\",\n          \"quote_text\": \"...to not despair of our present difficulties, but to believe always in the promise and greatness of America.\",\n          \"confidence\": 1.0,\n          \"context_type\": \"explicit_call_to_action\"\n        },\n        {\n          \"dimension\": \"envy\",\n          \"quote_text\": \"\",\n          \"confidence\": 1.0,\n          \"context_type\": \"absence_of_dimension\"\n        },\n        {\n          \"dimension\": \"compersion\",\n          \"quote_text\": \"But that he managed to do so by inspiring the hopes of so many millions of Americans who had once wrongly believed that they had little at stake or little influence in the election of an American president is something I deeply admire and commend him for achieving.\",\n          \"confidence\": 1.0,\n          \"context_type\": \"explicit_praise_of_opponent\"\n        },\n        {\n          \"dimension\": \"enmity\",\n          \"quote_text\": \"\",\n          \"confidence\": 1.0,\n          \"context_type\": \"absence_of_dimension\"\n        },\n        {\n          \"dimension\": \"amity\",\n          \"quote_text\": \"Whatever our differences, we are fellow Americans, and please believe me when I say no association has ever meant more to me than that.\",\n          \"confidence\": 1.0,\n          \"context_type\": \"explicit_statement\"\n        },\n        {\n          \"dimension\": \"fragmentative_goals\",\n          \"quote_text\": \"\",\n          \"confidence\": 1.0,\n          \"context_type\": \"absence_of_dimension\"\n        },\n        {\n          \"dimension\": \"cohesive_goals\",\n          \"quote_text\": \"I urge all Americans who supported me to join me in not just congratulating him, but offering our next president our good will and earnest effort to find ways to come together, to find the necessary compromises to bridge our differences...\",\n          \"confidence\": 1.0,\n          \"context_type\": \"explicit_call_to_action\"\n        }\n      ]\n    }\n  ]\n}\n<<<END_DISCERNUS_ANALYSIS_JSON_v6>>>",
              "evidence_hash": "0b9340b5e338fe925df3041374e611d4d88ff0e6626135f457c110b52d9c3cdd",
              "execution_metadata": {
                "start_time": "2025-08-29T15:46:43.935344+00:00",
                "end_time": "2025-08-29T15:47:32.445056+00:00",
                "duration_seconds": 48.509691
              },
              "input_artifacts": {
                "framework_hash": "77e927d6773a3131ec6b0fa5ef666cbcd957859357ebe6ae80efaeb7be557b12",
                "document_hashes": [
                  "ff9b26f20ad6dfa10cbf8ce4b7353fddab5e7cce5879e6b4603b8af60d0a9e35"
                ],
                "num_documents": 1
              },
              "provenance": {
                "security_boundary": {
                  "experiment_name": "simple_test_cff",
                  "experiment_root": "/Volumes/code/discernus/projects/simple_test_cff",
                  "boundary_type": "filesystem",
                  "security_level": "experiment_scoped"
                },
                "audit_session_id": "20250829T154643Z_5c1e6644"
              }
            }
          },
          {
            "analysis_id": "analysis_5039147acdd4",
            "result_hash": "9feeb61943a14fd7e3332f9f28f2584d4cc0f020704499cb3a3d823de83da2bf",
            "duration_seconds": 46.672486,
            "result_content": {
              "analysis_id": "analysis_5039147acdd4",
              "agent_name": "EnhancedAnalysisAgent",
              "agent_version": "enhanced_v2.1_raw_output",
              "experiment_name": "simple_test",
              "model_used": "vertex_ai/gemini-2.5-pro",
              "raw_analysis_response": "<<<DISCERNUS_ANALYSIS_JSON_v6>>>\n{\n  \"analysis_metadata\": {\n    \"framework_name\": \"cohesive_flourishing_framework\",\n    \"framework_version\": \"10.2\",\n    \"analyst_confidence\": 0.95,\n    \"analysis_notes\": \"The document is a political speech characterized by strong, unambiguous rhetoric. The dominant dimensions of Fear, Enmity, and Tribal Dominance are exceptionally clear and well-evidenced, making confidence in their scoring very high. Conversely, the cohesive dimensions (Amity, Compersion, Cohesive Goals) are almost entirely absent, which is also scored with high confidence. The analysis focuses on the explicit rhetorical strategies and emotionally charged narratives used throughout the speech.\"\n  },\n  \"document_analyses\": [\n    {\n      \"document_id\": \"{artifact_id}\",\n      \"document_name\": \"steve_king_2017_house_floor.txt\",\n      \"dimensional_scores\": {\n        \"tribal_dominance\": {\n          \"raw_score\": 0.85,\n          \"salience\": 0.9,\n          \"confidence\": 0.95\n        },\n        \"individual_dignity\": {\n          \"raw_score\": 0.1,\n          \"salience\": 0.1,\n          \"confidence\": 0.9\n        },\n        \"fear\": {\n          \"raw_score\": 0.9,\n          \"salience\": 0.9,\n          \"confidence\": 1.0\n        },\n        \"hope\": {\n          \"raw_score\": 0.2,\n          \"salience\": 0.2,\n          \"confidence\": 0.9\n        },\n        \"envy\": {\n          \"raw_score\": 0.6,\n          \"salience\": 0.5,\n          \"confidence\": 0.85\n        },\n        \"compersion\": {\n          \"raw_score\": 0.0,\n          \"salience\": 0.0,\n          \"confidence\": 1.0\n        },\n        \"enmity\": {\n          \"raw_score\": 0.9,\n          \"salience\": 0.95,\n          \"confidence\": 1.0\n        },\n        \"amity\": {\n          \"raw_score\": 0.0,\n          \"salience\": 0.0,\n          \"confidence\": 1.0\n        },\n        \"fragmentative_goals\": {\n          \"raw_score\": 0.8,\n          \"salience\": 0.8,\n          \"confidence\": 0.95\n        },\n        \"cohesive_goals\": {\n          \"raw_score\": 0.1,\n          \"salience\": 0.2,\n          \"confidence\": 0.8\n        }\n      },\n      \"evidence\": [\n        {\n          \"dimension\": \"tribal_dominance\",\n          \"quote_text\": \"to push Obamacare down the throats of the American people.\",\n          \"confidence\": 0.95,\n          \"context_type\": \"in-group/out-group framing\"\n        },\n        {\n          \"dimension\": \"individual_dignity\",\n          \"quote_text\": \"That being one of God's children is good enough to be protected by the law, but everybody treated equally.\",\n          \"confidence\": 0.7,\n          \"context_type\": \"isolated appeal to universal principle\"\n        },\n        {\n          \"dimension\": \"fear\",\n          \"quote_text\": \"Sarah Root would be alive today if the President had done his job, if law enforcement had been allowed to do their job, if ICE had responded when local law enforcement called them.\",\n          \"confidence\": 1.0,\n          \"context_type\": \"existential threat perception\"\n        },\n        {\n          \"dimension\": \"hope\",\n          \"quote_text\": \"This is the time we must defend our Constitution and we must nominate and elect a president of the United States who will make those appointments to the Supreme Court who believe the Constitution means what it says.\",\n          \"confidence\": 0.9,\n          \"context_type\": \"conditional vision of restoration\"\n        },\n        {\n          \"dimension\": \"envy\",\n          \"quote_text\": \"The Chief Justice of the Supreme Court decided that he could write words into Obamacare that didn\u2019t exist... They made it up.\",\n          \"confidence\": 0.9,\n          \"context_type\": \"grievance over illegitimate power\"\n        },\n        {\n          \"dimension\": \"compersion\",\n          \"quote_text\": \"\",\n          \"confidence\": 1.0,\n          \"context_type\": \"absent dimension\"\n        },\n        {\n          \"dimension\": \"enmity\",\n          \"quote_text\": \"This is the face of one of these perpetrators, Mauricio Hernandez. What did he do? Mauricio Hernandez, a sexual predator who impregnated a 13-year-old daughter of his living girlfriend.\",\n          \"confidence\": 1.0,\n          \"context_type\": \"adversarial characterization\"\n        },\n        {\n          \"dimension\": \"amity\",\n          \"quote_text\": \"\",\n          \"confidence\": 1.0,\n          \"context_type\": \"absent dimension\"\n        },\n        {\n          \"dimension\": \"fragmentative_goals\",\n          \"quote_text\": \"No hearing, no, no confirmation in the Senate, no vote in the in the Judiciary Committee, and no vote on the floor of the Senate for this lame duck President's appointments because we have a Constitution that's got to be restored.\",\n          \"confidence\": 1.0,\n          \"context_type\": \"explicit zero-sum objective\"\n        },\n        {\n          \"dimension\": \"cohesive_goals\",\n          \"quote_text\": \"Secure our borders. Restore their respect for the rule of law. Save these lives.\",\n          \"confidence\": 0.8,\n          \"context_type\": \"goal framed as restoration and enforcement\"\n        }\n      ]\n    }\n  ]\n}\n<<<END_DISCERNUS_ANALYSIS_JSON_v6>>>",
              "evidence_hash": "ab865aa2399ab2a230aecba1c9f8016094bbbba504cb016b117f5b8ac74d6baf",
              "execution_metadata": {
                "start_time": "2025-08-29T15:47:32.448893+00:00",
                "end_time": "2025-08-29T15:48:19.121389+00:00",
                "duration_seconds": 46.672486
              },
              "input_artifacts": {
                "framework_hash": "77e927d6773a3131ec6b0fa5ef666cbcd957859357ebe6ae80efaeb7be557b12",
                "document_hashes": [
                  "738780d93cc3c43b7b2e292a7fd0aa9f7e438f7ad2555be4ce6bfc20d9efda82"
                ],
                "num_documents": 1
              },
              "provenance": {
                "security_boundary": {
                  "experiment_name": "simple_test_cff",
                  "experiment_root": "/Volumes/code/discernus/projects/simple_test_cff",
                  "boundary_type": "filesystem",
                  "security_level": "experiment_scoped"
                },
                "audit_session_id": "20250829T154643Z_5c1e6644"
              }
            }
          },
          {
            "analysis_id": "analysis_e183eef92a4d",
            "result_hash": "a8d54c783b5cb705aa13c22a8f839bdb358bb14ff727f1d2639d181e1f92a065",
            "duration_seconds": 46.899221,
            "result_content": {
              "analysis_id": "analysis_e183eef92a4d",
              "agent_name": "EnhancedAnalysisAgent",
              "agent_version": "enhanced_v2.1_raw_output",
              "experiment_name": "simple_test",
              "model_used": "vertex_ai/gemini-2.5-pro",
              "raw_analysis_response": "<<<DISCERNUS_ANALYSIS_JSON_v6>>>\n{\n  \"analysis_metadata\": {\n    \"framework_name\": \"cohesive_flourishing_framework\",\n    \"framework_version\": \"10.2\",\n    \"analyst_confidence\": 0.95,\n    \"analysis_notes\": \"Analysis based on the 'default' variant. The document is a clear example of populist economic rhetoric, characterized by a strong in-group ('the people') vs. out-group ('oligarchs') framing. This leads to high scores in dimensions like Enmity, Envy, and Tribal Dominance. Cohesive elements like Hope and Amity are present but framed as tools for in-group mobilization against the out-group.\"\n  },\n  \"document_analyses\": [\n    {\n      \"document_id\": \"{artifact_id}\",\n      \"document_name\": \"bernie_sanders_2025_fighting_oligarchy.txt\",\n      \"dimensional_scores\": {\n        \"tribal_dominance\": {\n          \"raw_score\": 0.7,\n          \"salience\": 0.9,\n          \"confidence\": 0.95\n        },\n        \"individual_dignity\": {\n          \"raw_score\": 0.2,\n          \"salience\": 0.1,\n          \"confidence\": 0.8\n        },\n        \"fear\": {\n          \"raw_score\": 0.8,\n          \"salience\": 0.8,\n          \"confidence\": 0.95\n        },\n        \"hope\": {\n          \"raw_score\": 0.6,\n          \"salience\": 0.4,\n          \"confidence\": 0.9\n        },\n        \"envy\": {\n          \"raw_score\": 0.9,\n          \"salience\": 0.9,\n          \"confidence\": 0.95\n        },\n        \"compersion\": {\n          \"raw_score\": 0.0,\n          \"salience\": 0.0,\n          \"confidence\": 1.0\n        },\n        \"enmity\": {\n          \"raw_score\": 0.9,\n          \"salience\": 0.9,\n          \"confidence\": 0.95\n        },\n        \"amity\": {\n          \"raw_score\": 0.5,\n          \"salience\": 0.5,\n          \"confidence\": 0.9\n        },\n        \"fragmentative_goals\": {\n          \"raw_score\": 0.8,\n          \"salience\": 0.8,\n          \"confidence\": 0.95\n        },\n        \"cohesive_goals\": {\n          \"raw_score\": 0.5,\n          \"salience\": 0.4,\n          \"confidence\": 0.9\n        }\n      },\n      \"evidence\": [\n        {\n          \"dimension\": \"tribal_dominance\",\n          \"quote_text\": \"Abraham Lincoln talked about a government of the people, by the people, for the people. Well, Trump has a government of the billionaires, by the billionaires, and for the billionaires.\",\n          \"confidence\": 0.95,\n          \"context_type\": \"rhetorical_contrast\"\n        },\n        {\n          \"dimension\": \"individual_dignity\",\n          \"quote_text\": \"...we can create the kind of nation that we deserve.\",\n          \"confidence\": 0.7,\n          \"context_type\": \"concluding_statement\"\n        },\n        {\n          \"dimension\": \"fear\",\n          \"quote_text\": \"They are prepared to destroy Social Security, Medicaid, Medicare, the Veterans Administration in order to make themselves even richer.\",\n          \"confidence\": 1.0,\n          \"context_type\": \"accusation_of_threat\"\n        },\n        {\n          \"dimension\": \"hope\",\n          \"quote_text\": \"So if we stand together, are strong, are disciplined, are smart, I have every reason to believe deeply in my heart that not only will we defeat Trumpism, but we can create the kind of nation that we deserve.\",\n          \"confidence\": 0.95,\n          \"context_type\": \"call_to_action\"\n        },\n        {\n          \"dimension\": \"envy\",\n          \"quote_text\": \"Meanwhile, there has been a $75 trillion transfer of wealth from the bottom 90% to the top 1%. That is what a rigged economy is about, and that is what we are going to change.\",\n          \"confidence\": 1.0,\n          \"context_type\": \"zero_sum_framing\"\n        },\n        {\n          \"dimension\": \"compersion\",\n          \"quote_text\": \"\",\n          \"confidence\": 1.0,\n          \"context_type\": \"absence_of_evidence\"\n        },\n        {\n          \"dimension\": \"enmity\",\n          \"quote_text\": \"But I will tell you this, in the midst of all of these addictions, the worst and most dangerous addiction we have is the greed of the oligarchs.\",\n          \"confidence\": 1.0,\n          \"context_type\": \"character_assassination\"\n        },\n        {\n          \"dimension\": \"amity\",\n          \"quote_text\": \"So if we stand together, are strong, are disciplined, are smart, I have every reason to believe deeply in my heart that not only will we defeat Trumpism, but we can create the kind of nation that we deserve.\",\n          \"confidence\": 0.9,\n          \"context_type\": \"in_group_solidarity_appeal\"\n        },\n        {\n          \"dimension\": \"fragmentative_goals\",\n          \"quote_text\": \"That is what a rigged economy is about, and that is what we are going to change.\",\n          \"confidence\": 0.95,\n          \"context_type\": \"statement_of_objective\"\n        },\n        {\n          \"dimension\": \"cohesive_goals\",\n          \"quote_text\": \"...not only will we defeat Trumpism, but we can create the kind of nation that we deserve.\",\n          \"confidence\": 0.9,\n          \"context_type\": \"statement_of_vision\"\n        }\n      ]\n    }\n  ]\n}\n<<<END_DISCERNUS_ANALYSIS_JSON_v6>>>",
              "evidence_hash": "8d7b38cdad5ed82af092f4fe397ff22acde5c189213364785ad87e9e0f82f6f1",
              "execution_metadata": {
                "start_time": "2025-08-29T15:48:19.122251+00:00",
                "end_time": "2025-08-29T15:49:06.021481+00:00",
                "duration_seconds": 46.899221
              },
              "input_artifacts": {
                "framework_hash": "77e927d6773a3131ec6b0fa5ef666cbcd957859357ebe6ae80efaeb7be557b12",
                "document_hashes": [
                  "261b893a384411f76907e78e7997860cd9be5d959334a6b9ae1386ea1ba6cbdd"
                ],
                "num_documents": 1
              },
              "provenance": {
                "security_boundary": {
                  "experiment_name": "simple_test_cff",
                  "experiment_root": "/Volumes/code/discernus/projects/simple_test_cff",
                  "boundary_type": "filesystem",
                  "security_level": "experiment_scoped"
                },
                "audit_session_id": "20250829T154643Z_5c1e6644"
              }
            }
          },
          {
            "analysis_id": "analysis_648630eae46a",
            "result_hash": "64ee764a21af6c63a272bd5bd617e65e3db509fbda6395a1312bf036a8cd8ddb",
            "duration_seconds": 57.766415,
            "result_content": {
              "analysis_id": "analysis_648630eae46a",
              "agent_name": "EnhancedAnalysisAgent",
              "agent_version": "enhanced_v2.1_raw_output",
              "experiment_name": "simple_test",
              "model_used": "vertex_ai/gemini-2.5-pro",
              "raw_analysis_response": "<<<DISCERNUS_ANALYSIS_JSON_v6>>>\n{\n  \"analysis_metadata\": {\n    \"framework_name\": \"cohesive_flourishing_framework\",\n    \"framework_version\": \"10.2\",\n    \"analyst_confidence\": 0.9,\n    \"analysis_notes\": \"The analysis focuses on the speaker's rhetorical construction of a class-based conflict. The speech strongly delineates an 'in-group' (the working class) and an 'out-group' (the oligarchy), attributing malicious intent and illegitimate success to the latter. The primary rhetorical strategy is to foster in-group solidarity (Amity, Cohesive Goals) to fight an external enemy (Enmity, Fragmentative Goals).\"\n  },\n  \"document_analyses\": [\n    {\n      \"document_id\": \"{artifact_id}\",\n      \"document_name\": \"alexandria_ocasio_cortez_2025_fighting_oligarchy.txt\",\n      \"dimensional_scores\": {\n        \"tribal_dominance\": {\n          \"raw_score\": 0.7,\n          \"salience\": 0.8,\n          \"confidence\": 0.9\n        },\n        \"individual_dignity\": {\n          \"raw_score\": 0.8,\n          \"salience\": 0.7,\n          \"confidence\": 0.95\n        },\n        \"fear\": {\n          \"raw_score\": 0.8,\n          \"salience\": 0.8,\n          \"confidence\": 0.9\n        },\n        \"hope\": {\n          \"raw_score\": 0.5,\n          \"salience\": 0.5,\n          \"confidence\": 0.85\n        },\n        \"envy\": {\n          \"raw_score\": 0.9,\n          \"salience\": 0.9,\n          \"confidence\": 1.0\n        },\n        \"compersion\": {\n          \"raw_score\": 0.0,\n          \"salience\": 0.0,\n          \"confidence\": 1.0\n        },\n        \"enmity\": {\n          \"raw_score\": 0.9,\n          \"salience\": 0.9,\n          \"confidence\": 1.0\n        },\n        \"amity\": {\n          \"raw_score\": 0.8,\n          \"salience\": 0.8,\n          \"confidence\": 0.95\n        },\n        \"fragmentative_goals\": {\n          \"raw_score\": 0.8,\n          \"salience\": 0.8,\n          \"confidence\": 0.9\n        },\n        \"cohesive_goals\": {\n          \"raw_score\": 0.8,\n          \"salience\": 0.8,\n          \"confidence\": 0.95\n        }\n      },\n      \"evidence\": [\n        {\n          \"dimension\": \"tribal_dominance\",\n          \"quote_text\": \"The same billionaires are taking a wrecking ball to our country and they derive their power from dividing working people apart.\",\n          \"confidence\": 0.9,\n          \"context_type\": \"characterization_of_outgroup\"\n        },\n        {\n          \"dimension\": \"individual_dignity\",\n          \"quote_text\": \"If you are willing to fight for someone you don\u2019t know, you are welcome here.\",\n          \"confidence\": 0.95,\n          \"context_type\": \"statement_of_inclusive_values\"\n        },\n        {\n          \"dimension\": \"fear\",\n          \"quote_text\": \"And our political system is ill-prepared for this abuse of power. In fact, much of our political system enables it, starting with the role of money in politics.\",\n          \"confidence\": 0.9,\n          \"context_type\": \"description_of_systemic_threat\"\n        },\n        {\n          \"dimension\": \"hope\",\n          \"quote_text\": \"Because in this house, we stand together, we know that, that it's our only choice because we know that without exception, if we stand together, it is the only way that we can win.\",\n          \"confidence\": 0.9,\n          \"context_type\": \"statement_of_conditional_optimism\"\n        },\n        {\n          \"dimension\": \"envy\",\n          \"quote_text\": \"Now it's this idea that if we just work hard, we too can have nation-state level money, except these kinds of spoils aren\u2019t earned really. They aren't working for these billions. They're stealing them. They're stealing them. They're stealing them from you and you and me.\",\n          \"confidence\": 1.0,\n          \"context_type\": \"delegitimization_of_outgroup_success\"\n        },\n        {\n          \"dimension\": \"compersion\",\n          \"quote_text\": \"\",\n          \"confidence\": 1.0,\n          \"context_type\": \"absence_of_evidence\"\n        },\n        {\n          \"dimension\": \"enmity\",\n          \"quote_text\": \"We need to come together and spend every day between now and election day working to educate our neighbors, and give Evans and Boebert the boot, and replace them with a brawling Democrat who will stand for Colorado.\",\n          \"confidence\": 1.0,\n          \"context_type\": \"adversarial_call_to_action\"\n        },\n        {\n          \"dimension\": \"amity\",\n          \"quote_text\": \"Because in this house, we stand together, we know that, that it's our only choice because we know that without exception, if we stand together, it is the only way that we can win.\",\n          \"confidence\": 0.95,\n          \"context_type\": \"call_for_in-group_solidarity\"\n        },\n        {\n          \"dimension\": \"fragmentative_goals\",\n          \"quote_text\": \"Donald Trump does see the immense pressure that working people are under. But his answer is an America that operates on the principle of every man for himself, divide and conquer.\",\n          \"confidence\": 0.9,\n          \"context_type\": \"attribution_of_divisive_goals_to_opponent\"\n        },\n        {\n          \"dimension\": \"cohesive_goals\",\n          \"quote_text\": \"So I hope that you see this movement is not about partisan labels or purity tests, but about class solidarity.\",\n          \"confidence\": 1.0,\n          \"context_type\": \"explicit_statement_of_unifying_goal\"\n        }\n      ]\n    }\n  ]\n}\n<<<END_DISCERNUS_ANALYSIS_JSON_v6>>>",
              "evidence_hash": "791961db7154e75bcc838bb36e036666bd8924f552207bcee7f4f336187c9c2b",
              "execution_metadata": {
                "start_time": "2025-08-29T15:49:06.022342+00:00",
                "end_time": "2025-08-29T15:50:03.788777+00:00",
                "duration_seconds": 57.766415
              },
              "input_artifacts": {
                "framework_hash": "77e927d6773a3131ec6b0fa5ef666cbcd957859357ebe6ae80efaeb7be557b12",
                "document_hashes": [
                  "1121e4ae679ce6e6c08c6d2d9aa4ce0c6e5040e8b13405fcfd9ea725b8ad5ff6"
                ],
                "num_documents": 1
              },
              "provenance": {
                "security_boundary": {
                  "experiment_name": "simple_test_cff",
                  "experiment_root": "/Volumes/code/discernus/projects/simple_test_cff",
                  "boundary_type": "filesystem",
                  "security_level": "experiment_scoped"
                },
                "audit_session_id": "20250829T154643Z_5c1e6644"
              }
            }
          }
        ],
        "columns_added": []
      },
      "status": "success_with_data",
      "validation_passed": true
    }
  },
  "statistical_results": {
    "generation_metadata": {
      "status": "success",
      "functions_generated": 4,
      "output_file": "automatedstatisticalanalysisagent_functions.py",
      "module_size": 19872,
      "function_code_content": "\"\"\"\nAutomated Statistical Analysis Functions\n========================================\n\nGenerated by AutomatedStatisticalAnalysisAgent for experiment: simple_test\nDescription: Statistical analysis experiment\nGenerated: 2025-08-29T15:34:44.929821+00:00\n\nThis module contains automatically generated statistical analysis functions\nfor comprehensive data analysis including ANOVA, correlations, reliability,\nand hypothesis testing as appropriate for the research questions.\n\"\"\"\n\nimport pandas as pd\nimport numpy as np\nimport scipy.stats as stats\nfrom typing import Dict, Any, Optional, List, Tuple\nimport warnings\n\n# Suppress common statistical warnings for cleaner output\nwarnings.filterwarnings('ignore', category=RuntimeWarning)\n\n\ndef calculate_derived_metrics(data, **kwargs):\n    \"\"\"\n    Calculates all derived metrics as specified in the Cohesive Flourishing Framework v10.\n\n    This function implements the formulas for tension indices, the strategic contradiction index,\n    and the three salience-weighted cohesion indices. It handles known discrepancies between\n    the framework specification (e.g., 'compersion', 'enmity') and the actual data column\n    names (e.g., 'competition_raw', 'enity_raw'). The calculated metrics are appended as new\n    columns to the input DataFrame.\n\n    Args:\n        data (pd.DataFrame): DataFrame containing the raw analysis data with columns for\n                             raw scores and salience for each of the 10 dimensions.\n        **kwargs: Additional parameters (not used).\n\n    Returns:\n        pd.DataFrame: The original DataFrame with added columns for each derived metric,\n                      or None if essential columns are missing.\n    \"\"\"\n    import pandas as pd\n    import numpy as np\n    import json\n    import glob\n    from pathlib import Path\n\n    try:\n        df = data.copy()\n\n        # Define a mapping from framework concepts to actual column names\n        # This handles typos and discrepancies (e.g., enity vs enmity, competition vs compersion)\n        col_map = {\n            'tribal_dominance_score': 'tribal_dominance_raw',\n            'tribal_dominance_salience': 'tribal_dominance_salience',\n            'individual_dignity_score': 'individual_dignity_raw',\n            'individual_dignity_salience': 'individual_dignity_salience',\n            'fear_score': 'fear_raw',\n            'fear_salience': 'fear_salience',\n            'hope_score': 'hope_raw',\n            'hope_salience': 'hope_salience',\n            'envy_score': 'envy_raw',\n            'envy_salience': 'envy_salience',\n            'compersion_score': 'competition_raw',  # Mismatch\n            'compersion_salience': 'competition_salience', # Mismatch\n            'enmity_score': 'enity_raw', # Typo\n            'enmity_salience': 'enity_salience', # Typo\n            'amity_score': 'amity_raw',\n            'amity_salience': 'amity_salience',\n            'fragmentative_goals_score': 'fragmentative_goals_raw',\n            'fragmentative_goals_salience': 'fragmentative_goals_salience',\n            'cohesive_goals_score': 'cohesive_goals_raw',\n            'cohesive_goals_salience': 'cohesive_goals_salience'\n        }\n\n        # Verify all necessary columns exist\n        required_cols = list(col_map.values())\n        if not all(col in df.columns for col in required_cols):\n            # Log or print which columns are missing for debugging\n            missing = [col for col in required_cols if col not in df.columns]\n            # print(f\"Error: Missing required columns: {missing}\")\n            return None\n\n        # --- Tension Indices ---\n        df['identity_tension'] = np.minimum(df[col_map['tribal_dominance_score']], df[col_map['individual_dignity_score']]) * \\\n                                 abs(df[col_map['tribal_dominance_salience']] - df[col_map['individual_dignity_salience']])\n\n        df['emotional_tension'] = np.minimum(df[col_map['fear_score']], df[col_map['hope_score']]) * \\\n                                  abs(df[col_map['fear_salience']] - df[col_map['hope_salience']])\n\n        df['success_tension'] = np.minimum(df[col_map['envy_score']], df[col_map['compersion_score']]) * \\\n                                abs(df[col_map['envy_salience']] - df[col_map['compersion_salience']])\n\n        df['relational_tension'] = np.minimum(df[col_map['enmity_score']], df[col_map['amity_score']]) * \\\n                                   abs(df[col_map['enmity_salience']] - df[col_map['amity_salience']])\n\n        df['goal_tension'] = np.minimum(df[col_map['fragmentative_goals_score']], df[col_map['cohesive_goals_score']]) * \\\n                             abs(df[col_map['fragmentative_goals_salience']] - df[col_map['cohesive_goals_salience']])\n\n        # --- Strategic Contradiction Index ---\n        tension_cols = ['identity_tension', 'emotional_tension', 'success_tension', 'relational_tension', 'goal_tension']\n        df['strategic_contradiction_index'] = df[tension_cols].mean(axis=1)\n\n        # --- Salience-Weighted Cohesion Indices ---\n        epsilon = 0.001\n\n        # Intermediate Components\n        identity_comp = (df[col_map['individual_dignity_score']] * df[col_map['individual_dignity_salience']]) - \\\n                        (df[col_map['tribal_dominance_score']] * df[col_map['tribal_dominance_salience']])\n        emotional_comp = (df[col_map['hope_score']] * df[col_map['hope_salience']]) - \\\n                         (df[col_map['fear_score']] * df[col_map['fear_salience']])\n        success_comp = (df[col_map['compersion_score']] * df[col_map['compersion_salience']]) - \\\n                       (df[col_map['envy_score']] * df[col_map['envy_salience']])\n        relational_comp = (df[col_map['amity_score']] * df[col_map['amity_salience']]) - \\\n                          (df[col_map['enmity_score']] * df[col_map['enmity_salience']])\n        goal_comp = (df[col_map['cohesive_goals_score']] * df[col_map['cohesive_goals_salience']]) - \\\n                    (df[col_map['fragmentative_goals_score']] * df[col_map['fragmentative_goals_salience']])\n\n        # Salience Totals for Normalization\n        descriptive_salience_total = df[col_map['hope_salience']] + df[col_map['fear_salience']] + \\\n                                     df[col_map['compersion_salience']] + df[col_map['envy_salience']] + \\\n                                     df[col_map['amity_salience']] + df[col_map['enmity_salience']]\n\n        motivational_salience_total = descriptive_salience_total + \\\n                                      df[col_map['cohesive_goals_salience']] + df[col_map['fragmentative_goals_salience']]\n\n        full_salience_total = motivational_salience_total + \\\n                              df[col_map['individual_dignity_salience']] + df[col_map['tribal_dominance_salience']]\n\n        # Final Indices\n        df['descriptive_cohesion_index'] = (emotional_comp + success_comp + relational_comp) / (descriptive_salience_total + epsilon)\n        df['motivational_cohesion_index'] = (emotional_comp + success_comp + relational_comp + goal_comp) / (motivational_salience_total + epsilon)\n        df['full_cohesion_index'] = (identity_comp + emotional_comp + success_comp + relational_comp + goal_comp) / (full_salience_total + epsilon)\n        \n        # Clip values to be within [-1.0, 1.0] range to handle any edge cases with epsilon\n        cohesion_indices = ['descriptive_cohesion_index', 'motivational_cohesion_index', 'full_cohesion_index']\n        for col in cohesion_indices:\n            df[col] = df[col].clip(-1.0, 1.0)\n\n        return df\n\n    except Exception as e:\n        # print(f\"An error occurred in calculate_derived_metrics: {e}\")\n        return None\n\ndef calculate_descriptive_statistics(data, **kwargs):\n    \"\"\"\n    Calculates and returns descriptive statistics for key CFF v10 metrics.\n\n    This function first computes the derived metrics (tensions and cohesion indices)\n    and then generates summary statistics (mean, std, min, 25%, 50%, 75%, max) for\n    both the original raw scores and the newly calculated derived metrics. This provides\n    a baseline overview of the corpus characteristics as per the research questions.\n\n    Args:\n        data (pd.DataFrame): DataFrame containing the raw analysis data.\n        **kwargs: Additional parameters (not used).\n\n    Returns:\n        dict: A dictionary containing the descriptive statistics, or None if an error occurs.\n    \"\"\"\n    import pandas as pd\n    import numpy as np\n    import json\n    import glob\n    from pathlib import Path\n\n    try:\n        # First, ensure derived metrics are calculated\n        data_with_metrics = calculate_derived_metrics(data)\n        if data_with_metrics is None:\n            return None\n\n        # Select columns for descriptive statistics\n        raw_scores = [col for col in data.columns if '_raw' in col]\n        derived_metrics = [\n            'identity_tension', 'emotional_tension', 'success_tension', 'relational_tension', 'goal_tension',\n            'strategic_contradiction_index', 'descriptive_cohesion_index', 'motivational_cohesion_index',\n            'full_cohesion_index'\n        ]\n        \n        cols_to_describe = raw_scores + derived_metrics\n        \n        # Filter to only include columns that actually exist in the dataframe\n        cols_to_describe = [col for col in cols_to_describe if col in data_with_metrics.columns]\n\n        if not cols_to_describe:\n            return None\n\n        # Calculate descriptive statistics\n        descriptives = data_with_metrics[cols_to_describe].describe()\n\n        # Convert to a dictionary for a clean JSON-compatible output\n        return descriptives.to_dict()\n\n    except Exception as e:\n        # print(f\"An error occurred in calculate_descriptive_statistics: {e}\")\n        return None\n\ndef calculate_correlation_matrix(data, **kwargs):\n    \"\"\"\n    Calculates the Pearson correlation matrix for key CFF v10 metrics.\n\n    This analysis explores the relationships between the primary dimensions (raw scores)\n    and the main composite indices (cohesion and tension). It helps to understand how\n    different rhetorical elements co-occur within the corpus.\n\n    Args:\n        data (pd.DataFrame): DataFrame containing the raw analysis data.\n        **kwargs: Additional parameters (not used).\n\n    Returns:\n        dict: A dictionary representing the correlation matrix, or None if an error occurs.\n    \"\"\"\n    import pandas as pd\n    import numpy as np\n    import json\n    import glob\n    from pathlib import Path\n\n    try:\n        # First, ensure derived metrics are calculated\n        data_with_metrics = calculate_derived_metrics(data)\n        if data_with_metrics is None:\n            return None\n\n        # Select columns for correlation analysis\n        raw_scores = [col for col in data.columns if '_raw' in col]\n        key_indices = [\n            'strategic_contradiction_index',\n            'full_cohesion_index'\n        ]\n        \n        cols_to_correlate = raw_scores + key_indices\n        \n        # Filter to only include columns that actually exist in the dataframe\n        cols_to_correlate = [col for col in cols_to_correlate if col in data_with_metrics.columns]\n\n        if len(cols_to_correlate) < 2:\n            return None\n\n        # Calculate the correlation matrix\n        correlation_matrix = data_with_metrics[cols_to_correlate].corr(method='pearson')\n\n        # Replace NaN values that can occur if a column has zero variance\n        correlation_matrix = correlation_matrix.fillna(0)\n\n        return correlation_matrix.to_dict()\n\n    except Exception as e:\n        # print(f\"An error occurred in calculate_correlation_matrix: {e}\")\n        return None\n\ndef compare_styles_on_cohesion(data, **kwargs):\n    \"\"\"\n    Compares cohesion scores between 'Institutional' and 'Populist' rhetorical styles.\n\n    This function addresses the research question about whether institutional discourse\n    (represented by John McCain's concession speech) exhibits higher cohesion than\n    populist discourse. It uses an independent samples t-test to compare the means of\n    the three main cohesion indices between the two groups. Levene's test is used to\n    check for homogeneity of variances.\n\n    Methodology:\n    1. A 'rhetorical_style' group is created based on document names.\n    2. Derived metrics are calculated.\n    3. For each cohesion index, an independent samples t-test is performed.\n    4. Results, including t-statistic and p-value, are returned.\n\n    Args:\n        data (pd.DataFrame): DataFrame containing the raw analysis data.\n        **kwargs: Additional parameters (not used).\n\n    Returns:\n        dict: A dictionary of t-test results for each cohesion index, or None if\n              groups are not viable for comparison.\n    \"\"\"\n    import pandas as pd\n    import numpy as np\n    import json\n    import glob\n    from pathlib import Path\n    from scipy.stats import ttest_ind, levene\n\n    try:\n        # First, ensure derived metrics are calculated\n        df = calculate_derived_metrics(data)\n        if df is None:\n            return None\n\n        # Define grouping based on document name, as per prompt instructions\n        # This mapping is derived from the implicit corpus understanding.\n        def get_style(doc_name):\n            if 'john_mccain' in doc_name:\n                return 'Institutional'\n            # All others are categorized as populist for this comparison\n            elif 'steve_king' in doc_name or 'bernie_sanders' in doc_name or 'alexandria_ocasio_cortez' in doc_name:\n                return 'Populist'\n            return 'Other'\n\n        df['rhetorical_style'] = df['document_name'].apply(get_style)\n\n        # Isolate the two groups for comparison\n        institutional_group = df[df['rhetorical_style'] == 'Institutional']\n        populist_group = df[df['rhetorical_style'] == 'Populist']\n\n        # Check if groups are large enough for a t-test\n        if len(institutional_group) < 2 or len(populist_group) < 2:\n            return {\n                \"status\": \"Error: Insufficient data for one or both groups.\",\n                \"institutional_group_size\": len(institutional_group),\n                \"populist_group_size\": len(populist_group)\n            }\n\n        results = {}\n        cohesion_indices = ['descriptive_cohesion_index', 'motivational_cohesion_index', 'full_cohesion_index']\n\n        for index in cohesion_indices:\n            group1 = institutional_group[index].dropna()\n            group2 = populist_group[index].dropna()\n\n            if len(group1) < 2 or len(group2) < 2:\n                results[index] = \"Skipped: insufficient data for this index.\"\n                continue\n\n            # Levene's test for homogeneity of variances\n            levene_stat, levene_p = levene(group1, group2)\n            equal_var = levene_p > 0.05\n\n            # Independent samples t-test\n            t_stat, p_value = ttest_ind(group1, group2, equal_var=equal_var, nan_policy='omit')\n\n            results[index] = {\n                'institutional_mean': group1.mean(),\n                'populist_mean': group2.mean(),\n                't_statistic': t_stat,\n                'p_value': p_value,\n                'levene_p_value': levene_p,\n                'equal_variances_assumed': equal_var\n            }\n\n        return results\n\n    except Exception as e:\n        # print(f\"An error occurred in compare_styles_on_cohesion: {e}\")\n        return None\n\ndef run_complete_statistical_analysis(data: pd.DataFrame, alpha: float = 0.05) -> Dict[str, Any]:\n    \"\"\"\n    Run complete statistical analysis suite on the dataset.\n    \n    Args:\n        data: pandas DataFrame with dimension scores\n        alpha: Significance level for hypothesis tests (default: 0.05)\n        \n    Returns:\n        Dictionary with all statistical analysis results\n    \"\"\"\n    results = {\n        'analysis_metadata': {\n            'timestamp': pd.Timestamp.now().isoformat(),\n            'sample_size': len(data),\n            'alpha_level': alpha,\n            'variables_analyzed': list(data.select_dtypes(include=[np.number]).columns)\n        }\n    }\n    \n    # Get all analysis functions from this module\n    import inspect\n    current_module = inspect.getmodule(inspect.currentframe())\n    \n    for name, obj in inspect.getmembers(current_module):\n        if (inspect.isfunction(obj) and \n            name.startswith(('calculate_', 'perform_', 'test_')) and \n            name != 'run_complete_statistical_analysis'):\n            try:\n                # Pass alpha parameter to functions that might need it\n                if 'alpha' in inspect.signature(obj).parameters:\n                    results[name] = obj(data, alpha=alpha)\n                else:\n                    results[name] = obj(data)\n            except Exception as e:\n                results[name] = {'error': f'Analysis failed: {str(e)}'}\n                \n    return results\n\n\ndef perform_statistical_analysis(data: pd.DataFrame) -> Dict[str, Any]:\n    \"\"\"\n    Template-compatible wrapper function for statistical analysis.\n    \n    This function is called by the universal notebook template and performs\n    comprehensive statistical analysis on the provided dataset.\n    \n    Args:\n        data: pandas DataFrame with dimension scores and derived metrics\n        \n    Returns:\n        Dictionary containing all statistical analysis results\n    \"\"\"\n    return run_complete_statistical_analysis(data)\n\n\ndef generate_statistical_summary_report(analysis_results: Dict[str, Any]) -> str:\n    \"\"\"\n    Generate a human-readable summary report from statistical analysis results.\n    \n    Args:\n        analysis_results: Results from run_complete_statistical_analysis()\n        \n    Returns:\n        String containing formatted statistical report\n    \"\"\"\n    report_lines = []\n    report_lines.append(\"STATISTICAL ANALYSIS SUMMARY REPORT\")\n    report_lines.append(\"=\" * 50)\n    \n    metadata = analysis_results.get('analysis_metadata', {})\n    report_lines.append(f\"Analysis Timestamp: {metadata.get('timestamp', 'Unknown')}\")\n    report_lines.append(f\"Sample Size: {metadata.get('sample_size', 'Unknown')}\")\n    report_lines.append(f\"Alpha Level: {metadata.get('alpha_level', 'Unknown')}\")\n    report_lines.append(f\"Variables: {len(metadata.get('variables_analyzed', []))}\")\n    report_lines.append(\"\")\n    \n    # Summarize key findings\n    for analysis_name, result in analysis_results.items():\n        if analysis_name != 'analysis_metadata' and isinstance(result, dict):\n            if 'error' not in result:\n                report_lines.append(f\"{analysis_name.replace('_', ' ').title()}:\")\n                \n                # Extract key statistics based on analysis type\n                if 'p_value' in result:\n                    p_val = result['p_value']\n                    significance = \"significant\" if p_val < metadata.get('alpha_level', 0.05) else \"not significant\"\n                    report_lines.append(f\"  - p-value: {p_val:.4f} ({significance})\")\n                \n                if 'effect_size' in result:\n                    report_lines.append(f\"  - Effect size: {result['effect_size']:.4f}\")\n                \n                if 'correlation_matrix' in result:\n                    report_lines.append(f\"  - Correlation matrix generated with {len(result['correlation_matrix'])} variables\")\n                \n                if 'cronbach_alpha' in result:\n                    alpha_val = result['cronbach_alpha']\n                    reliability = \"excellent\" if alpha_val > 0.9 else \"good\" if alpha_val > 0.8 else \"acceptable\" if alpha_val > 0.7 else \"questionable\"\n                    report_lines.append(f\"  - Cronbach's \u03b1: {alpha_val:.3f} ({reliability})\")\n                \n                report_lines.append(\"\")\n            else:\n                report_lines.append(f\"{analysis_name}: ERROR - {result['error']}\")\n                report_lines.append(\"\")\n    \n    return \"\\n\".join(report_lines)\n",
      "cached_with_code": true
    },
    "statistical_data": {
      "calculate_correlation_matrix": null,
      "calculate_derived_metrics": null,
      "calculate_descriptive_statistics": null,
      "compare_styles_on_cohesion": null,
      "generate_statistical_summary_report": "STATISTICAL ANALYSIS SUMMARY REPORT\n==================================================\nAnalysis Timestamp: Unknown\nSample Size: Unknown\nAlpha Level: Unknown\nVariables: 0\n",
      "perform_statistical_analysis": {
        "analysis_metadata": {
          "timestamp": "2025-08-29T11:50:05.355229",
          "sample_size": 4,
          "alpha_level": 0.05,
          "variables_analyzed": [
            "tribal_dominance_raw",
            "tribal_dominance_salience",
            "tribal_dominance_confidence",
            "individual_dignity_raw",
            "individual_dignity_salience",
            "individual_dignity_confidence",
            "fear_raw",
            "fear_salience",
            "fear_confidence",
            "hope_raw",
            "hope_salience",
            "hope_confidence",
            "envy_raw",
            "envy_salience",
            "envy_confidence",
            "compersion_raw",
            "compersion_salience",
            "compersion_confidence",
            "enmity_raw",
            "enmity_salience",
            "enmity_confidence",
            "amity_raw",
            "amity_salience",
            "amity_confidence",
            "fragmentative_goals_raw",
            "fragmentative_goals_salience",
            "fragmentative_goals_confidence",
            "cohesive_goals_raw",
            "cohesive_goals_salience",
            "cohesive_goals_confidence"
          ]
        }
      },
      "run_complete_statistical_analysis": {
        "analysis_metadata": {
          "timestamp": "2025-08-29T11:50:05.359587",
          "sample_size": 4,
          "alpha_level": 0.05,
          "variables_analyzed": [
            "tribal_dominance_raw",
            "tribal_dominance_salience",
            "tribal_dominance_confidence",
            "individual_dignity_raw",
            "individual_dignity_salience",
            "individual_dignity_confidence",
            "fear_raw",
            "fear_salience",
            "fear_confidence",
            "hope_raw",
            "hope_salience",
            "hope_confidence",
            "envy_raw",
            "envy_salience",
            "envy_confidence",
            "compersion_raw",
            "compersion_salience",
            "compersion_confidence",
            "enmity_raw",
            "enmity_salience",
            "enmity_confidence",
            "amity_raw",
            "amity_salience",
            "amity_confidence",
            "fragmentative_goals_raw",
            "fragmentative_goals_salience",
            "fragmentative_goals_confidence",
            "cohesive_goals_raw",
            "cohesive_goals_salience",
            "cohesive_goals_confidence"
          ]
        }
      }
    },
    "status": "success_with_data",
    "validation_passed": true
  }
}