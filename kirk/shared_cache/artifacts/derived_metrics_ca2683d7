{
  "analysis_id": "analysis_5124cead",
  "step": "derived_metrics_generation",
  "model_used": "vertex_ai/gemini-2.5-flash-lite",
  "derived_metrics": "```python\nimport json\nimport math\n\n# Provided scores\ndimensional_scores_input = {\n  \"tribal_dominance\": {\n    \"raw_score\": 0.8,\n    \"salience\": 0.8,\n    \"confidence\": 0.9\n  },\n  \"individual_dignity\": {\n    \"raw_score\": 0.3,\n    \"salience\": 0.2,\n    \"confidence\": 0.8\n  },\n  \"fear\": {\n    \"raw_score\": 0.9,\n    \"salience\": 0.9,\n    \"confidence\": 0.95\n  },\n  \"hope\": {\n    \"raw_score\": 0.4,\n    \"salience\": 0.2,\n    \"confidence\": 0.8\n  },\n  \"envy\": {\n    \"raw_score\": 0.6,\n    \"salience\": 0.5,\n    \"confidence\": 0.85\n  },\n  \"mudita\": {\n    \"raw_score\": 0.0,\n    \"salience\": 0.0,\n    \"confidence\": 1.0\n  },\n  \"enmity\": {\n    \"raw_score\": 0.9,\n    \"salience\": 0.8,\n    \"confidence\": 0.95\n  },\n  \"amity\": {\n    \"raw_score\": 0.1,\n    \"salience\": 0.1,\n    \"confidence\": 0.9\n  },\n  \"fragmentative_goals\": {\n    \"raw_score\": 0.8,\n    \"salience\": 0.7,\n    \"confidence\": 0.9\n  },\n  \"cohesive_goals\": {\n    \"raw_score\": 0.5,\n    \"salience\": 0.4,\n    \"confidence\": 0.8\n  }\n}\n\n# --- Derived Metrics Calculation ---\n\n# Helper function to safely access nested dictionary values\ndef safe_get(data, keys, default=None):\n    for key in keys:\n        try:\n            data = data[key]\n        except (KeyError, TypeError):\n            return default\n    return data\n\n# Dictionary to hold intermediate and final derived metrics\nderived_metrics = {}\n\n# 5.4: Derived Metrics Calculations\n\n# Basic tension indices\nderived_metrics[\"identity_tension\"] = min(\n    safe_get(dimensional_scores_input, [\"tribal_dominance\", \"raw_score\"]),\n    safe_get(dimensional_scores_input, [\"individual_dignity\", \"raw_score\"])\n) * abs(\n    safe_get(dimensional_scores_input, [\"tribal_dominance\", \"salience\"]) -\n    safe_get(dimensional_scores_input, [\"individual_dignity\", \"salience\"])\n)\n\nderived_metrics[\"emotional_tension\"] = min(\n    safe_get(dimensional_scores_input, [\"fear\", \"raw_score\"]),\n    safe_get(dimensional_scores_input, [\"hope\", \"raw_score\"])\n) * abs(\n    safe_get(dimensional_scores_input, [\"fear\", \"salience\"]) -\n    safe_get(dimensional_scores_input, [\"hope\", \"salience\"])\n)\n\nderived_metrics[\"success_tension\"] = min(\n    safe_get(dimensional_scores_input, [\"envy\", \"raw_score\"]),\n    safe_get(dimensional_scores_input, [\"mudita\", \"raw_score\"])\n) * abs(\n    safe_get(dimensional_scores_input, [\"envy\", \"salience\"]) -\n    safe_get(dimensional_scores_input, [\"mudita\", \"salience\"])\n)\n\nderived_metrics[\"relational_tension\"] = min(\n    safe_get(dimensional_scores_input, [\"enmity\", \"raw_score\"]),\n    safe_get(dimensional_scores_input, [\"amity\", \"raw_score\"])\n) * abs(\n    safe_get(dimensional_scores_input, [\"enmity\", \"salience\"]) -\n    safe_get(dimensional_scores_input, [\"amity\", \"salience\"])\n)\n\nderived_metrics[\"goal_tension\"] = min(\n    safe_get(dimensional_scores_input, [\"fragmentative_goals\", \"raw_score\"]),\n    safe_get(dimensional_scores_input, [\"cohesive_goals\", \"raw_score\"])\n) * abs(\n    safe_get(dimensional_scores_input, [\"fragmentative_goals\", \"salience\"]) -\n    safe_get(dimensional_scores_input, [\"cohesive_goals\", \"salience\"])\n)\n\n# Strategic coherence index\n# Sum of tension indices divided by 5\nsum_of_tensions = (\n    derived_metrics[\"identity_tension\"] +\n    derived_metrics[\"emotional_tension\"] +\n    derived_metrics[\"success_tension\"] +\n    derived_metrics[\"relational_tension\"] +\n    derived_metrics[\"goal_tension\"]\n)\nderived_metrics[\"strategic_contradiction_index\"] = sum_of_tensions / 5\n\n# Intermediate calculations for salience-weighted cohesion indices\nderived_metrics[\"emotional_cohesion_component\"] = (\n    safe_get(dimensional_scores_input, [\"hope\", \"raw_score\"]) * safe_get(dimensional_scores_input, [\"hope\", \"salience\"]) -\n    safe_get(dimensional_scores_input, [\"fear\", \"raw_score\"]) * safe_get(dimensional_scores_input, [\"fear\", \"salience\"])\n)\n\nderived_metrics[\"success_cohesion_component\"] = (\n    safe_get(dimensional_scores_input, [\"mudita\", \"raw_score\"]) * safe_get(dimensional_scores_input, [\"mudita\", \"salience\"]) -\n    safe_get(dimensional_scores_input, [\"envy\", \"raw_score\"]) * safe_get(dimensional_scores_input, [\"envy\", \"salience\"])\n)\n\nderived_metrics[\"relational_cohesion_component\"] = (\n    safe_get(dimensional_scores_input, [\"amity\", \"raw_score\"]) * safe_get(dimensional_scores_input, [\"amity\", \"salience\"]) -\n    safe_get(dimensional_scores_input, [\"enmity\", \"raw_score\"]) * safe_get(dimensional_scores_input, [\"enmity\", \"salience\"])\n)\n\nderived_metrics[\"goal_cohesion_component\"] = (\n    safe_get(dimensional_scores_input, [\"cohesive_goals\", \"raw_score\"]) * safe_get(dimensional_scores_input, [\"cohesive_goals\", \"salience\"]) -\n    safe_get(dimensional_scores_input, [\"fragmentative_goals\", \"raw_score\"]) * safe_get(dimensional_scores_input, [\"fragmentative_goals\", \"salience\"])\n)\n\nderived_metrics[\"identity_cohesion_component\"] = (\n    safe_get(dimensional_scores_input, [\"individual_dignity\", \"raw_score\"]) * safe_get(dimensional_scores_input, [\"individual_dignity\", \"salience\"]) -\n    safe_get(dimensional_scores_input, [\"tribal_dominance\", \"raw_score\"]) * safe_get(dimensional_scores_input, [\"tribal_dominance\", \"salience\"])\n)\n\n# Salience weight calculations (denominator for cohesion indices)\n# Adding epsilon (0.001) to prevent division by zero\n\nderived_metrics[\"descriptive_salience_total\"] = (\n    safe_get(dimensional_scores_input, [\"hope\", \"salience\"]) +\n    safe_get(dimensional_scores_input, [\"fear\", \"salience\"]) +\n    safe_get(dimensional_scores_input, [\"mudita\", \"salience\"]) +\n    safe_get(dimensional_scores_input, [\"envy\", \"salience\"]) +\n    safe_get(dimensional_scores_input, [\"amity\", \"salience\"]) +\n    safe_get(dimensional_scores_input, [\"enmity\", \"salience\"])\n)\n\nderived_metrics[\"motivational_salience_total\"] = (\n    safe_get(dimensional_scores_input, [\"hope\", \"salience\"]) +\n    safe_get(dimensional_scores_input, [\"fear\", \"salience\"]) +\n    safe_get(dimensional_scores_input, [\"mudita\", \"salience\"]) +\n    safe_get(dimensional_scores_input, [\"envy\", \"salience\"]) +\n    safe_get(dimensional_scores_input, [\"amity\", \"salience\"]) +\n    safe_get(dimensional_scores_input, [\"enmity\", \"salience\"]) +\n    safe_get(dimensional_scores_input, [\"cohesive_goals\", \"salience\"]) +\n    safe_get(dimensional_scores_input, [\"fragmentative_goals\", \"salience\"])\n)\n\nderived_metrics[\"full_salience_total\"] = (\n    safe_get(dimensional_scores_input, [\"individual_dignity\", \"salience\"]) +\n    safe_get(dimensional_scores_input, [\"tribal_dominance\", \"salience\"]) +\n    safe_get(dimensional_scores_input, [\"hope\", \"salience\"]) +\n    safe_get(dimensional_scores_input, [\"fear\", \"salience\"]) +\n    safe_get(dimensional_scores_input, [\"mudita\", \"salience\"]) +\n    safe_get(dimensional_scores_input, [\"envy\", \"salience\"]) +\n    safe_get(dimensional_scores_input, [\"amity\", \"salience\"]) +\n    safe_get(dimensional_scores_input, [\"enmity\", \"salience\"]) +\n    safe_get(dimensional_scores_input, [\"cohesive_goals\", \"salience\"]) +\n    safe_get(dimensional_scores_input, [\"fragmentative_goals\", \"salience\"])\n)\n\n# Final salience-weighted cohesion indices\nderived_metrics[\"descriptive_cohesion_index\"] = (\n    derived_metrics[\"emotional_cohesion_component\"] +\n    derived_metrics[\"success_cohesion_component\"] +\n    derived_metrics[\"relational_cohesion_component\"]\n) / (derived_metrics[\"descriptive_salience_total\"] + 0.001)\n\nderived_metrics[\"motivational_cohesion_index\"] = (\n    derived_metrics[\"emotional_cohesion_component\"] +\n    derived_metrics[\"success_cohesion_component\"] +\n    derived_metrics[\"relational_cohesion_component\"] +\n    derived_metrics[\"goal_cohesion_component\"]\n) / (derived_metrics[\"motivational_salience_total\"] + 0.001)\n\nderived_metrics[\"full_cohesion_index\"] = (\n    derived_metrics[\"identity_cohesion_component\"] +\n    derived_metrics[\"emotional_cohesion_component\"] +\n    derived_metrics[\"success_cohesion_component\"] +\n    derived_metrics[\"relational_cohesion_component\"] +\n    derived_metrics[\"goal_cohesion_component\"]\n) / (derived_metrics[\"full_salience_total\"] + 0.001)\n\n# Ensure indices are within -1.0 to 1.0 range, clipping if necessary due to float precision or extreme values\nfor key in derived_metrics:\n    if key.endswith(\"_index\"): # Only apply clipping to the final indices\n        derived_metrics[key] = max(-1.0, min(1.0, derived_metrics[key]))\n\n# Print the results\nprint(json.dumps(derived_metrics, indent=2))\n```\n\n```json\n{\n  \"identity_tension\": 0.24,\n  \"emotional_tension\": 0.48,\n  \"success_tension\": 0.0,\n  \"relational_tension\": 0.08,\n  \"goal_tension\": 0.24,\n  \"strategic_contradiction_index\": 0.232,\n  \"emotional_cohesion_component\": -0.74,\n  \"success_cohesion_component\": -0.3,\n  \"relational_cohesion_component\": -0.8,\n  \"goal_cohesion_component\": -0.1,\n  \"identity_cohesion_component\": -0.02,\n  \"descriptive_salience_total\": 3.4,\n  \"motivational_salience_total\": 5.5,\n  \"full_salience_total\": 7.5,\n  \"descriptive_cohesion_index\": -0.5441176470588235,\n  \"motivational_cohesion_index\": -0.28,\n  \"full_cohesion_index\": -0.2048\n}\n```",
  "timestamp": "2025-09-15T20:29:04.043647+00:00"
}