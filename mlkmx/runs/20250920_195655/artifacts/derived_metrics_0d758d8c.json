{
  "analysis_id": "analysis_91cf6676",
  "step": "derived_metrics_generation",
  "model_used": "vertex_ai/gemini-2.5-flash-lite",
  "raw_metrics_response": "```python\nimport json\nimport math\n\n# Provided dimensional scores for document_1\ndocument_scores = {\n  \"tribal_dominance\": {\n    \"raw_score\": 0.1,\n    \"salience\": 0.1,\n    \"confidence\": 0.95\n  },\n  \"individual_dignity\": {\n    \"raw_score\": 0.9,\n    \"salience\": 0.9,\n    \"confidence\": 0.95\n  },\n  \"fear\": {\n    \"raw_score\": 0.8,\n    \"salience\": 0.7,\n    \"confidence\": 0.95\n  },\n  \"hope\": {\n    \"raw_score\": 0.95,\n    \"salience\": 0.9,\n    \"confidence\": 1.0\n  },\n  \"envy\": {\n    \"raw_score\": 0.1,\n    \"salience\": 0.05,\n    \"confidence\": 0.95\n  },\n  \"compersion\": {\n    \"raw_score\": 0.7,\n    \"salience\": 0.6,\n    \"confidence\": 0.95\n  },\n  \"enmity\": {\n    \"raw_score\": 0.8,\n    \"salience\": 0.75,\n    \"confidence\": 0.95\n  },\n  \"amity\": {\n    \"raw_score\": 0.85,\n    \"salience\": 0.8,\n    \"confidence\": 0.95\n  },\n  \"fragmentative_goals\": {\n    \"raw_score\": 0.05,\n    \"salience\": 0.05,\n    \"confidence\": 0.95\n  },\n  \"cohesive_goals\": {\n    \"raw_score\": 0.9,\n    \"salience\": 0.9,\n    \"confidence\": 0.95\n  }\n}\n\n# Function to calculate derived metrics based on the CFF framework\ndef calculate_derived_metrics(scores):\n    derived_metrics = {}\n\n    # --- Tension Indices ---\n    derived_metrics[\"identity_tension\"] = min(scores[\"tribal_dominance\"][\"raw_score\"], scores[\"individual_dignity\"][\"raw_score\"]) * abs(scores[\"tribal_dominance\"][\"salience\"] - scores[\"individual_dignity\"][\"salience\"])\n    derived_metrics[\"emotional_tension\"] = min(scores[\"fear\"][\"raw_score\"], scores[\"hope\"][\"raw_score\"]) * abs(scores[\"fear\"][\"salience\"] - scores[\"hope\"][\"salience\"])\n    derived_metrics[\"success_tension\"] = min(scores[\"envy\"][\"raw_score\"], scores[\"compersion\"][\"raw_score\"]) * abs(scores[\"envy\"][\"salience\"] - scores[\"compersion\"][\"salience\"])\n    derived_metrics[\"relational_tension\"] = min(scores[\"enmity\"][\"raw_score\"], scores[\"amity\"][\"raw_score\"]) * abs(scores[\"enmity\"][\"salience\"] - scores[\"amity\"][\"salience\"])\n    derived_metrics[\"goal_tension\"] = min(scores[\"fragmentative_goals\"][\"raw_score\"], scores[\"cohesive_goals\"][\"raw_score\"]) * abs(scores[\"fragmentative_goals\"][\"salience\"] - scores[\"cohesive_goals\"][\"salience\"])\n\n    # --- Strategic Contradiction Index ---\n    # Ensure all tension indices are present before calculating the average\n    tension_indices = [\n        derived_metrics.get(\"identity_tension\", 0),\n        derived_metrics.get(\"emotional_tension\", 0),\n        derived_metrics.get(\"success_tension\", 0),\n        derived_metrics.get(\"relational_tension\", 0),\n        derived_metrics.get(\"goal_tension\", 0)\n    ]\n    derived_metrics[\"strategic_contradiction_index\"] = sum(tension_indices) / 5.0 if tension_indices else 0.0\n\n    # --- Intermediate calculations for Salience-Weighted Cohesion Indices ---\n    emotional_cohesion_component = (scores[\"hope\"][\"raw_score\"] * scores[\"hope\"][\"salience\"]) - (scores[\"fear\"][\"raw_score\"] * scores[\"fear\"][\"salience\"])\n    success_cohesion_component = (scores[\"compersion\"][\"raw_score\"] * scores[\"compersion\"][\"salience\"]) - (scores[\"envy\"][\"raw_score\"] * scores[\"envy\"][\"salience\"])\n    relational_cohesion_component = (scores[\"amity\"][\"raw_score\"] * scores[\"amity\"][\"salience\"]) - (scores[\"enmity\"][\"raw_score\"] * scores[\"enmity\"][\"salience\"])\n    goal_cohesion_component = (scores[\"cohesive_goals\"][\"raw_score\"] * scores[\"cohesive_goals\"][\"salience\"]) - (scores[\"fragmentative_goals\"][\"raw_score\"] * scores[\"fragmentative_goals\"][\"salience\"])\n    identity_cohesion_component = (scores[\"individual_dignity\"][\"raw_score\"] * scores[\"individual_dignity\"][\"salience\"]) - (scores[\"tribal_dominance\"][\"raw_score\"] * scores[\"tribal_dominance\"][\"salience\"])\n\n    derived_metrics[\"emotional_cohesion_component\"] = emotional_cohesion_component\n    derived_metrics[\"success_cohesion_component\"] = success_cohesion_component\n    derived_metrics[\"relational_cohesion_component\"] = relational_cohesion_component\n    derived_metrics[\"goal_cohesion_component\"] = goal_cohesion_component\n    derived_metrics[\"identity_cohesion_component\"] = identity_cohesion_component\n\n    # --- Salience Weight Calculations ---\n    descriptive_salience_total = (\n        scores[\"hope\"][\"salience\"] + scores[\"fear\"][\"salience\"] +\n        scores[\"compersion\"][\"salience\"] + scores[\"envy\"][\"salience\"] +\n        scores[\"amity\"][\"salience\"] + scores[\"enmity\"][\"salience\"]\n    )\n    motivational_salience_total = (\n        scores[\"hope\"][\"salience\"] + scores[\"fear\"][\"salience\"] +\n        scores[\"compersion\"][\"salience\"] + scores[\"envy\"][\"salience\"] +\n        scores[\"amity\"][\"salience\"] + scores[\"enmity\"][\"salience\"] +\n        scores[\"cohesive_goals\"][\"salience\"] + scores[\"fragmentative_goals\"][\"salience\"]\n    )\n    full_salience_total = (\n        scores[\"individual_dignity\"][\"salience\"] + scores[\"tribal_dominance\"][\"salience\"] +\n        scores[\"hope\"][\"salience\"] + scores[\"fear\"][\"salience\"] +\n        scores[\"compersion\"][\"salience\"] + scores[\"envy\"][\"salience\"] +\n        scores[\"amity\"][\"salience\"] + scores[\"enmity\"][\"salience\"] +\n        scores[\"cohesive_goals\"][\"salience\"] + scores[\"fragmentative_goals\"][\"salience\"]\n    )\n\n    derived_metrics[\"descriptive_salience_total\"] = descriptive_salience_total\n    derived_metrics[\"motivational_salience_total\"] = motivational_salience_total\n    derived_metrics[\"full_salience_total\"] = full_salience_total\n\n    # --- Final Salience-Weighted Cohesion Indices ---\n    epsilon = 0.001 # To prevent division by zero\n\n    derived_metrics[\"descriptive_cohesion_index\"] = (\n        emotional_cohesion_component + success_cohesion_component + relational_cohesion_component\n    ) / (descriptive_salience_total + epsilon)\n\n    derived_metrics[\"motivational_cohesion_index\"] = (\n        emotional_cohesion_component + success_cohesion_component + relational_cohesion_component + goal_cohesion_component\n    ) / (motivational_salience_total + epsilon)\n\n    derived_metrics[\"full_cohesion_index\"] = (\n        identity_cohesion_component + emotional_cohesion_component + success_cohesion_component +\n        relational_cohesion_component + goal_cohesion_component\n    ) / (full_salience_total + epsilon)\n\n    return derived_metrics\n\n# Calculate the derived metrics\ncalculated_metrics = calculate_derived_metrics(document_scores)\n\n# Print the results in a readable format\nprint(\"--- Calculated Derived Metrics ---\")\nfor metric, value in calculated_metrics.items():\n    print(f\"{metric}: {value:.4f}\")\n\n```\n```json\n{\n    \"identity_tension\": 0.0,\n    \"emotional_tension\": 0.0,\n    \"success_tension\": 0.0,\n    \"relational_tension\": 0.0,\n    \"goal_tension\": 0.0,\n    \"strategic_contradiction_index\": 0.0,\n    \"emotional_cohesion_component\": 0.845,\n    \"success_cohesion_component\": 0.35,\n    \"relational_cohesion_component\": 0.025,\n    \"goal_cohesion_component\": 0.805,\n    \"identity_cohesion_component\": 0.72,\n    \"descriptive_salience_total\": 3.95,\n    \"motivational_salience_total\": 4.95,\n    \"full_salience_total\": 5.05,\n    \"descriptive_cohesion_index\": 0.4329,\n    \"motivational_cohesion_index\": 0.3959,\n    \"full_cohesion_index\": 0.3545\n}\n```",
  "document_index": 1,
  "document_name": "document_1",
  "timestamp": "2025-09-20T20:01:01.268364+00:00"
}