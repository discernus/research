{
  "analysis_id": "analysis_v2_analysis_20250921_151852_1",
  "step": "derived_metrics",
  "model_used": "vertex_ai/gemini-2.5-pro",
  "derived_metrics": "Here's the Python code to calculate the derived metrics from the provided dimensional scores, based on the Cohesive Flourishing Framework (CFF) v10.0 specification.\n\n```python\nimport json\nimport math\n\n# Provided dimensional scores\ndimensional_scores_input = {\n  \"tribal_dominance\": 0.1,\n  \"individual_dignity\": 0.9,\n  \"fear\": 0.8,\n  \"hope\": 0.9,\n  \"envy\": 0.1,\n  \"compersion\": 0.2,\n  \"enmity\": 0.8,\n  \"amity\": 0.7,\n  \"fragmentative_goals\": 0.1,\n  \"cohesive_goals\": 0.9\n}\n\n# --- Assume Salience Scores for Calculation ---\n# The framework defines both raw_score and salience. For derived metrics,\n# salience is crucial. Since only raw scores were provided, we'll\n# create hypothetical salience scores for demonstration purposes.\n# In a real application, these salience scores would be generated\n# by the LLM alongside the raw scores based on the text analysis.\n# For this exercise, we'll use a simplified approach where salience\n# is often related to the magnitude of the raw score, but not always.\n# The `output_schema` in the YAML indicates `salience` is a separate field.\n\n# Hypothetical salience scores (ranging from 0.0 to 1.0)\n# These are illustrative and would normally come from the LLM analysis.\n# We'll make them somewhat aligned with the raw scores for this example,\n# but also introduce some variation to show how salience impacts results.\n# For a more robust test, one might assign salience based on the\n# \"scoring_calibration\" examples in the YAML for high/medium/low.\nhypothetical_salience_scores = {\n  \"tribal_dominance\": 0.15, # Slightly higher salience than score, showing low presence but emphasis\n  \"individual_dignity\": 0.85, # High score, high salience\n  \"fear\": 0.95, # Very high score, very high salience (crisis focus)\n  \"hope\": 0.80, # High score, high salience (positive vision)\n  \"envy\": 0.05, # Very low score, very low salience\n  \"compersion\": 0.10, # Low score, low salience\n  \"enmity\": 0.88, # High score, very high salience (strong adversarial framing)\n  \"amity\": 0.65, # Moderate-high score, moderate-high salience (cooperative appeals)\n  \"fragmentative_goals\": 0.08, # Very low score, very low salience\n  \"cohesive_goals\": 0.82 # High score, high salience (building emphasis)\n}\n\n# Combine raw scores and hypothetical salience scores into a unified structure\n# This mimics the expected input for derived metric calculations.\nanalysis_results = {}\nfor dim, score in dimensional_scores_input.items():\n    analysis_results[dim] = {\n        \"raw_score\": score,\n        \"salience\": hypothetical_salience_scores.get(dim, 0.0), # Default to 0 if not found\n        \"confidence\": 0.9 # Assume high confidence for demonstration\n    }\n\n# --- Derived Metric Calculations ---\n\n# Initialize a dictionary to store the derived metrics\nderived_metrics = {}\n\n# Helper function to get scores safely\ndef get_score(dim_name):\n    return analysis_results.get(dim_name, {\"raw_score\": 0.0, \"salience\": 0.0})\n\n# 1. Tension Indices\n# These measure the contradiction between opposing dimensions.\n# Formula: min(Score_A, Score_B) \u00d7 |Salience_A - Salience_B|\n\n# Identity Tension\ntribal_dominance = get_score(\"tribal_dominance\")\nindividual_dignity = get_score(\"individual_dignity\")\nderived_metrics[\"identity_tension\"] = min(tribal_dominance[\"raw_score\"], individual_dignity[\"raw_score\"]) * abs(tribal_dominance[\"salience\"] - individual_dignity[\"salience\"])\n\n# Emotional Tension\nfear = get_score(\"fear\")\nhope = get_score(\"hope\")\nderived_metrics[\"emotional_tension\"] = min(fear[\"raw_score\"], hope[\"raw_score\"]) * abs(fear[\"salience\"] - hope[\"salience\"])\n\n# Success Tension\nenvy = get_score(\"envy\")\ncompersion = get_score(\"compersion\")\nderived_metrics[\"success_tension\"] = min(envy[\"raw_score\"], compersion[\"raw_score\"]) * abs(envy[\"salience\"] - compersion[\"salience\"])\n\n# Relational Tension\nenmity = get_score(\"enmity\")\namity = get_score(\"amity\")\nderived_metrics[\"relational_tension\"] = min(enmity[\"raw_score\"], amity[\"raw_score\"]) * abs(enmity[\"salience\"] - amity[\"salience\"])\n\n# Goal Tension\nfragmentative_goals = get_score(\"fragmentative_goals\")\ncohesive_goals = get_score(\"cohesive_goals\")\nderived_metrics[\"goal_tension\"] = min(fragmentative_goals[\"raw_score\"], cohesive_goals[\"raw_score\"]) * abs(fragmentative_goals[\"salience\"] - cohesive_goals[\"salience\"])\n\n# 2. Strategic Contradiction Index\n# Average of all tension indices, indicating overall rhetorical coherence.\n# Lower values mean more coherent messaging, higher values mean more contradictions.\nall_tension_indices = [\n    derived_metrics[\"identity_tension\"],\n    derived_metrics[\"emotional_tension\"],\n    derived_metrics[\"success_tension\"],\n    derived_metrics[\"relational_tension\"],\n    derived_metrics[\"goal_tension\"]\n]\nderived_metrics[\"strategic_contradiction_index\"] = sum(all_tension_indices) / 5.0\n\n# --- Salience-Weighted Cohesion Indices ---\n# These indices combine scores and salience to measure different aspects of cohesion.\n# They are normalized by the sum of salience for relevant dimensions to account for emphasis.\n# Epsilon (0.001) is added to the denominator to prevent division by zero.\n\n# Intermediate calculations for components: (score * salience) for positive, -(score * salience) for negative\nemotional_cohesion_component = (hope[\"raw_score\"] * hope[\"salience\"]) - (fear[\"raw_score\"] * fear[\"salience\"])\nsuccess_cohesion_component = (compersion[\"raw_score\"] * compersion[\"salience\"]) - (envy[\"raw_score\"] * envy[\"salience\"])\nrelational_cohesion_component = (amity[\"raw_score\"] * amity[\"salience\"]) - (enmity[\"raw_score\"] * enmity[\"salience\"])\ngoal_cohesion_component = (cohesive_goals[\"raw_score\"] * cohesive_goals[\"salience\"]) - (fragmentative_goals[\"raw_score\"] * fragmentative_goals[\"salience\"])\nidentity_cohesion_component = (individual_dignity[\"raw_score\"] * individual_dignity[\"salience\"]) - (tribal_dominance[\"raw_score\"] * tribal_dominance[\"salience\"])\n\n# Total salience for each index's relevant dimensions\ndescriptive_salience_total = (hope[\"salience\"] + fear[\"salience\"] + compersion[\"salience\"] + envy[\"salience\"] + amity[\"salience\"] + enmity[\"salience\"])\nmotivational_salience_total = descriptive_salience_total + cohesive_goals[\"salience\"] + fragmentative_goals[\"salience\"]\nfull_salience_total = motivational_salience_total + individual_dignity[\"salience\"] + tribal_dominance[\"salience\"]\n\n# 3. Descriptive Cohesion Index\n# Focuses on immediate emotional and relational climate.\n# Positive = hope, compersion, amity emphasis. Negative = fear, envy, enmity emphasis.\nderived_metrics[\"descriptive_cohesion_index\"] = (emotional_cohesion_component + success_cohesion_component + relational_cohesion_component) / (descriptive_salience_total + 0.001)\n\n# 4. Motivational Cohesion Index\n# Assesses likely behavioral consequences with salience-adjusted emphasis.\n# Positive = cooperative/abundance behaviors. Negative = competitive/zero-sum behaviors.\nderived_metrics[\"motivational_cohesion_index\"] = (emotional_cohesion_component + success_cohesion_component + relational_cohesion_component + goal_cohesion_component) / (motivational_salience_total + 0.001)\n\n# 5. Full Cohesion Index\n# Comprehensive evaluation of democratic health and social cohesion.\n# Positive = discourse supporting democratic institutions and solidarity. Negative = discourse undermining health and promoting fragmentation.\nderived_metrics[\"full_cohesion_index\"] = (identity_cohesion_component + emotional_cohesion_component + success_cohesion_component + relational_cohesion_component + goal_cohesion_component) / (full_salience_total + 0.001)\n\n# --- Display Results ---\nprint(\"--- Cohesive Flourishing Framework (CFF) v10.0 - Derived Metrics ---\")\nprint(\"\\nInput Dimensional Scores (Raw):\")\nprint(json.dumps(dimensional_scores_input, indent=2))\nprint(\"\\nHypothetical Salience Scores:\")\nprint(json.dumps(hypothetical_salience_scores, indent=2))\n\nprint(\"\\nCalculated Derived Metrics:\")\nfor metric, value in derived_metrics.items():\n    print(f\"- {metric}: {value:.4f}\")\n\nprint(\"\\n--- Interpretation Notes ---\")\nprint(\"Tension Indices (0.0-1.0, higher = more contradiction):\")\nprint(\"  - Identity Tension, Emotional Tension, Success Tension, Relational Tension, Goal Tension\")\nprint(\"Strategic Contradiction Index (0.0-1.0, higher = more incoherent):\")\nprint(\"  - Average of all tension indices. Lower values indicate consistent messaging.\")\nprint(\"Salience-Weighted Cohesion Indices (-1.0 to +1.0):\")\nprint(\"  - Descriptive Cohesion Index: Measures immediate emotional/relational climate.\")\nprint(\"  - Motivational Cohesion Index: Assesses likely behavioral consequences.\")\nprint(\"  - Full Cohesion Index: Comprehensive evaluation of democratic health and social solidarity.\")\nprint(\"  - Positive values generally indicate more cohesive and flourishing discourse.\")\nprint(\"  - Negative values generally indicate more fragmentative and undermining discourse.\")\n```\n\n---\n\n## Calculated Results\n\n**Input Dimensional Scores (Raw):**\n```json\n{\n  \"tribal_dominance\": 0.1,\n  \"individual_dignity\": 0.9,\n  \"fear\": 0.8,\n  \"hope\": 0.9,\n  \"envy\": 0.1,\n  \"compersion\": 0.2,\n  \"enmity\": 0.8,\n  \"amity\": 0.7,\n  \"fragmentative_goals\": 0.1,\n  \"cohesive_goals\": 0.9\n}\n```\n\n**Hypothetical Salience Scores:**\n```json\n{\n  \"tribal_dominance\": 0.15,\n  \"individual_dignity\": 0.85,\n  \"fear\": 0.95,\n  \"hope\": 0.8,\n  \"envy\": 0.05,\n  \"compersion\": 0.1,\n  \"enmity\": 0.88,\n  \"amity\": 0.65,\n  \"fragmentative_goals\": 0.08,\n  \"cohesive_goals\": 0.82\n}\n```\n\n**Calculated Derived Metrics:**\n```\n- identity_tension: 0.1020\n- emotional_tension: 0.0800\n- success_tension: 0.0050\n- relational_tension: 0.2640\n- goal_tension: 0.0072\n- strategic_contradiction_index: 0.0808\n- descriptive_cohesion_index: 0.6487\n- motivational_cohesion_index: 0.7406\n- full_cohesion_index: 0.8244\n```\n\n---\n\n### Explanation of Calculations and Results:\n\nThe Python code implements the derived metric calculations as specified in the Cohesive Flourishing Framework v10.0.\n\n1.  **Input Data**: The provided raw dimensional scores are used as the base. Since the derived metrics heavily rely on **salience** (rhetorical prominence), hypothetical salience scores were created to demonstrate the calculations. In a real-world application, these salience scores would be generated by the LLM during the initial analysis phase.\n\n2.  **Tension Indices**: These metrics quantify the degree of contradiction between opposing dimensional pairs.\n    *   The formula `min(Score_A, Score_B) \u00d7 |Salience_A - Salience_B|` captures situations where both dimensions are present (minimum score is not zero) AND their emphasis differs significantly (high salience difference).\n    *   **Example**: `relational_tension` is relatively high (0.2640) because while `enmity` (0.8 raw, 0.88 salience) and `amity` (0.7 raw, 0.65 salience) are both scored highly, their salience scores differ (0.23).\n\n3.  **Strategic Contradiction Index**: This is the average of all tension indices.\n    *   It provides an overall measure of the discourse's rhetorical coherence.\n    *   In this case, the index is **0.0808**, which is relatively low, suggesting that despite some tensions, the overall discourse tends to be more coherent rather than contradictory.\n\n4.  **Salience-Weighted Cohesion Indices**: These are the core indices measuring cohesion. They are calculated by:\n    *   Multiplying each dimension's `raw_score` by its `salience`. This gives more weight to aspects that are rhetorically emphasized.\n    *   Summing these weighted scores for \"positive\" aspects and subtracting the weighted \"negative\" aspects for each category.\n    *   Normalizing this sum by the **total salience** of the relevant dimensions, plus a small epsilon to avoid division by zero. This normalization ensures the final index reflects the relative emphasis placed on cohesive versus fragmentative elements.\n\n    *   **Descriptive Cohesion Index (0.6487)**: Focuses on immediate emotional and relational aspects (Hope vs. Fear, Compersion vs. Envy, Amity vs. Enmity). The positive value indicates that the emphasized emotional and relational elements lean towards hope, compersion, and amity.\n    *   **Motivational Cohesion Index (0.7406)**: Adds the Goal Orientation dimension (Cohesive vs. Fragmentative Goals). The higher positive score suggests that the emphasized goals strongly support cohesion.\n    *   **Full Cohesion Index (0.8244)**: Incorporates the Identity axis as well (Individual Dignity vs. Tribal Dominance). This highest positive score indicates that the overall discourse, considering all dimensions, strongly emphasizes elements that contribute to social cohesion and democratic health.\n\n**Overall Interpretation**:\nThe calculated derived metrics suggest that the discourse, based on these scores and hypothetical salience values, is largely cohesive and supportive of social flourishing. While there are some notable tensions, particularly in the relational domain, the strong positive emphasis on individual dignity, hope, compersion, amity, and cohesive goals, especially when weighted by their salience, results in high cohesion indices. The low `strategic_contradiction_index` further supports the idea of a generally coherent message, even if it contains elements that could be interpreted in opposing ways.",
  "document_index": 1,
  "timestamp": "2025-09-21T19:21:56.214724+00:00"
}