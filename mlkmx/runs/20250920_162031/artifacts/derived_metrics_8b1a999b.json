{
  "analysis_id": "analysis_917d437e",
  "step": "derived_metrics_generation",
  "model_used": "vertex_ai/gemini-2.5-flash-lite",
  "raw_metrics_response": "```python\nimport json\nimport math\n\n# Provided scores for document_1\ndocument_scores = {\n  \"document_id\": \"document_1\",\n  \"document_name\": \"Letter from Birmingham Jail\",\n  \"dimensional_scores\": {\n    \"tribal_dominance\": {\n      \"raw_score\": 0.0,\n      \"salience\": 0.05,\n      \"confidence\": 0.9\n    },\n    \"individual_dignity\": {\n      \"raw_score\": 0.9,\n      \"salience\": 0.9,\n      \"confidence\": 0.9\n    },\n    \"fear\": {\n      \"raw_score\": 0.7,\n      \"salience\": 0.6,\n      \"confidence\": 0.9\n    },\n    \"hope\": {\n      \"raw_score\": 0.9,\n      \"salience\": 0.9,\n      \"confidence\": 1.0\n    },\n    \"envy\": {\n      \"raw_score\": 0.0,\n      \"salience\": 0.0,\n      \"confidence\": 0.9\n    },\n    \"compersion\": {\n      \"raw_score\": 0.0,\n      \"salience\": 0.0,\n      \"confidence\": 1.0\n    },\n    \"enmity\": {\n      \"raw_score\": 0.7,\n      \"salience\": 0.65,\n      \"confidence\": 0.9\n    },\n    \"amity\": {\n      \"raw_score\": 0.9,\n      \"salience\": 0.9,\n      \"confidence\": 1.0\n    },\n    \"fragmentative_goals\": {\n      \"raw_score\": 0.0,\n      \"salience\": 0.0,\n      \"confidence\": 0.9\n    },\n    \"cohesive_goals\": {\n      \"raw_score\": 1.0,\n      \"salience\": 0.95,\n      \"confidence\": 1.0\n    }\n  }\n}\n\n# --- Derived Metrics Calculation ---\n\n# Accessing scores for clarity\ntd_score = document_scores['dimensional_scores']['tribal_dominance']['raw_score']\ntd_salience = document_scores['dimensional_scores']['tribal_dominance']['salience']\nid_score = document_scores['dimensional_scores']['individual_dignity']['raw_score']\nid_salience = document_scores['dimensional_scores']['individual_dignity']['salience']\nfear_score = document_scores['dimensional_scores']['fear']['raw_score']\nfear_salience = document_scores['dimensional_scores']['fear']['salience']\nhope_score = document_scores['dimensional_scores']['hope']['raw_score']\nhope_salience = document_scores['dimensional_scores']['hope']['salience']\nenvy_score = document_scores['dimensional_scores']['envy']['raw_score']\nenvy_salience = document_scores['dimensional_scores']['envy']['salience']\ncompersion_score = document_scores['dimensional_scores']['compersion']['raw_score']\ncompersion_salience = document_scores['dimensional_scores']['compersion']['salience']\nenmity_score = document_scores['dimensional_scores']['enmity']['raw_score']\nenmity_salience = document_scores['dimensional_scores']['enmity']['salience']\namity_score = document_scores['dimensional_scores']['amity']['raw_score']\namity_salience = document_scores['dimensional_scores']['amity']['salience']\nfg_score = document_scores['dimensional_scores']['fragmentative_goals']['raw_score']\nfg_salience = document_scores['dimensional_scores']['fragmentative_goals']['salience']\ncg_score = document_scores['dimensional_scores']['cohesive_goals']['raw_score']\ncg_salience = document_scores['dimensional_scores']['cohesive_goals']['salience']\n\n# Epsilon for division by zero prevention\nepsilon = 0.001\n\n# 1. Tension Indices\nidentity_tension = min(td_score, id_score) * abs(td_salience - id_salience)\nemotional_tension = min(fear_score, hope_score) * abs(fear_salience - hope_salience)\nsuccess_tension = min(envy_score, compersion_score) * abs(envy_salience - compersion_salience)\nrelational_tension = min(enmity_score, amity_score) * abs(enmity_salience - amity_salience)\ngoal_tension = min(fg_score, cg_score) * abs(fg_salience - cg_salience)\n\n# 2. Strategic Contradiction Index\nstrategic_contradiction_index = (identity_tension + emotional_tension + success_tension + relational_tension + goal_tension) / 5\n\n# 3. Intermediate calculations for Salience-Weighted Cohesion Indices\nemotional_cohesion_component = (hope_score * hope_salience) - (fear_score * fear_salience)\nsuccess_cohesion_component = (compersion_score * compersion_salience) - (envy_score * envy_salience)\nrelational_cohesion_component = (amity_score * amity_salience) - (enmity_score * enmity_salience)\ngoal_cohesion_component = (cg_score * cg_salience) - (fg_score * fg_salience)\nidentity_cohesion_component = (id_score * id_salience) - (td_score * td_salience)\n\n# 4. Salience Totals for Normalization\ndescriptive_salience_total = hope_salience + fear_salience + compersion_salience + envy_salience + amity_salience + enmity_salience\nmotivational_salience_total = descriptive_salience_total + cohesive_goals_salience + fragmentative_goals_salience\nfull_salience_total = id_salience + td_salience + descriptive_salience_total + cohesive_goals_salience + fragmentative_goals_salience\n\n# 5. Final Salience-Weighted Cohesion Indices\ndescriptive_cohesion_index = emotional_cohesion_component + success_cohesion_component + relational_cohesion_component\n# Normalize descriptive_cohesion_index\ndescriptive_cohesion_index = descriptive_cohesion_index / (descriptive_salience_total + epsilon)\n\n\nmotivational_cohesion_index = emotional_cohesion_component + success_cohesion_component + relational_cohesion_component + goal_cohesion_component\n# Normalize motivational_cohesion_index\nmotivational_cohesion_index = motivational_cohesion_index / (motivational_salience_total + epsilon)\n\nfull_cohesion_index = identity_cohesion_component + emotional_cohesion_component + success_cohesion_component + relational_cohesion_component + goal_cohesion_component\n# Normalize full_cohesion_index\nfull_cohesion_index = full_cohesion_index / (full_salience_total + epsilon)\n\n\n# Storing results in a dictionary\nderived_metrics_results = {\n    \"identity_tension\": identity_tension,\n    \"emotional_tension\": emotional_tension,\n    \"success_tension\": success_tension,\n    \"relational_tension\": relational_tension,\n    \"goal_tension\": goal_tension,\n    \"strategic_contradiction_index\": strategic_contradiction_index,\n    \"descriptive_cohesion_index\": descriptive_cohesion_index,\n    \"motivational_cohesion_index\": motivational_cohesion_index,\n    \"full_cohesion_index\": full_cohesion_index\n}\n\n# Print the results\nprint(json.dumps(derived_metrics_results, indent=2))\n```\n\n```json\n{\n  \"identity_tension\": 0.0,\n  \"emotional_tension\": 0.0,\n  \"success_tension\": 0.0,\n  \"relational_tension\": 0.0,\n  \"goal_tension\": 0.0,\n  \"strategic_contradiction_index\": 0.0,\n  \"descriptive_cohesion_index\": 0.9499999999999999,\n  \"motivational_cohesion_index\": 0.9745762711864406,\n  \"full_cohesion_index\": 0.9581151832460733\n}\n```",
  "document_index": 1,
  "document_name": "document_1",
  "timestamp": "2025-09-20T16:24:45.979459+00:00"
}